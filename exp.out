nohup: ignoring input
Loading checkpoint shards:   0%|                                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|███████████████                                             | 1/4 [00:00<00:02,  1.39it/s]Loading checkpoint shards:  50%|██████████████████████████████                              | 2/4 [00:01<00:01,  1.39it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████               | 3/4 [00:02<00:00,  1.41it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.96it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.71it/s]
/home/hjkim/workspace/SpecExtend_Reb/eagle/model_eagle.py:105: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ea_layer_state_dict = torch.load(load_model_path,
Warming up GPUs...
Warmup complete!
dataset: pg-19, length: 1024
Warming up GPUs...
Warmup complete!
len=1024:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=1024:   5%|███▊                                                                        | 1/20 [00:05<01:43,  5.45s/it]len=1024:  10%|███████▌                                                                    | 2/20 [00:10<01:37,  5.44s/it]len=1024:  15%|███████████▍                                                                | 3/20 [00:16<01:31,  5.40s/it]len=1024:  20%|███████████████▏                                                            | 4/20 [00:21<01:26,  5.40s/it]len=1024:  25%|███████████████████                                                         | 5/20 [00:27<01:22,  5.49s/it]len=1024:  30%|██████████████████████▊                                                     | 6/20 [00:34<01:22,  5.91s/it]len=1024:  35%|██████████████████████████▌                                                 | 7/20 [00:39<01:15,  5.77s/it]len=1024:  40%|██████████████████████████████▍                                             | 8/20 [00:44<01:08,  5.68s/it]len=1024:  45%|██████████████████████████████████▏                                         | 9/20 [00:50<01:02,  5.64s/it]len=1024:  50%|█████████████████████████████████████▌                                     | 10/20 [00:55<00:55,  5.55s/it]len=1024:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:01<00:49,  5.51s/it]len=1024:  60%|█████████████████████████████████████████████                              | 12/20 [01:08<00:47,  5.91s/it]len=1024:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:13<00:40,  5.75s/it]len=1024:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:18<00:34,  5.67s/it]len=1024:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:24<00:27,  5.54s/it]len=1024:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:29<00:21,  5.40s/it]len=1024:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:34<00:16,  5.36s/it]len=1024:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [01:41<00:11,  5.69s/it]len=1024:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [01:46<00:05,  5.68s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [01:52<00:00,  5.61s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [01:52<00:00,  5.61s/it]

Generated 258 tokens in 2.73s. 
Token/sec: 94.52
Average acceptance length: 1.899

Generated 258 tokens in 2.71s. 
Token/sec: 95.07
Average acceptance length: 1.899

Generated 258 tokens in 2.72s. 
Token/sec: 94.86
Average acceptance length: 1.804

Generated 258 tokens in 2.72s. 
Token/sec: 94.86
Average acceptance length: 1.804

Generated 259 tokens in 2.67s. 
Token/sec: 97.05
Average acceptance length: 2.012

Generated 259 tokens in 2.67s. 
Token/sec: 97.05
Average acceptance length: 2.012

Generated 258 tokens in 2.71s. 
Token/sec: 95.34
Average acceptance length: 1.932

Generated 258 tokens in 2.70s. 
Token/sec: 95.39
Average acceptance length: 1.932

Generated 258 tokens in 2.83s. 
Token/sec: 91.27
Average acceptance length: 1.745

Generated 258 tokens in 2.83s. 
Token/sec: 91.25
Average acceptance length: 1.745

Generated 258 tokens in 2.69s. 
Token/sec: 96.0
Average acceptance length: 1.835

Generated 258 tokens in 4.04s. 
Token/sec: 63.94
Average acceptance length: 1.835

Generated 258 tokens in 2.74s. 
Token/sec: 94.28
Average acceptance length: 1.835

Generated 258 tokens in 2.74s. 
Token/sec: 94.31
Average acceptance length: 1.835

Generated 258 tokens in 2.74s. 
Token/sec: 94.1
Average acceptance length: 1.867

Generated 258 tokens in 2.74s. 
Token/sec: 94.16
Average acceptance length: 1.867

Generated 259 tokens in 2.76s. 
Token/sec: 93.79
Average acceptance length: 1.943

Generated 259 tokens in 2.79s. 
Token/sec: 92.9
Average acceptance length: 1.943

Generated 260 tokens in 2.66s. 
Token/sec: 97.67
Average acceptance length: 1.989

Generated 260 tokens in 2.68s. 
Token/sec: 97.05
Average acceptance length: 1.989

Generated 258 tokens in 2.72s. 
Token/sec: 95.01
Average acceptance length: 1.932

Generated 258 tokens in 2.70s. 
Token/sec: 95.4
Average acceptance length: 1.932

Generated 259 tokens in 2.72s. 
Token/sec: 95.11
Average acceptance length: 1.846

Generated 259 tokens in 4.08s. 
Token/sec: 63.4
Average acceptance length: 1.846

Generated 260 tokens in 2.70s. 
Token/sec: 96.35
Average acceptance length: 1.921

Generated 260 tokens in 2.70s. 
Token/sec: 96.32
Average acceptance length: 1.921

Generated 257 tokens in 2.73s. 
Token/sec: 94.19
Average acceptance length: 1.763

Generated 257 tokens in 2.75s. 
Token/sec: 93.53
Average acceptance length: 1.763

Generated 257 tokens in 2.62s. 
Token/sec: 97.99
Average acceptance length: 1.988

Generated 257 tokens in 2.62s. 
Token/sec: 98.02
Average acceptance length: 1.988

Generated 259 tokens in 2.53s. 
Token/sec: 102.25
Average acceptance length: 2.159

Generated 259 tokens in 2.53s. 
Token/sec: 102.32
Average acceptance length: 2.159

Generated 260 tokens in 2.62s. 
Token/sec: 99.21
Average acceptance length: 2.059

Generated 260 tokens in 2.63s. 
Token/sec: 98.73
Average acceptance length: 2.059

Generated 258 tokens in 2.57s. 
Token/sec: 100.58
Average acceptance length: 2.071

Generated 258 tokens in 3.91s. 
Token/sec: 66.02
Average acceptance length: 2.071

Generated 259 tokens in 2.85s. 
Token/sec: 90.94
Average acceptance length: 1.726

Generated 259 tokens in 2.79s. 
Token/sec: 92.78
Average acceptance length: 1.726

Generated 257 tokens in 2.73s. 
Token/sec: 94.16
Average acceptance length: 1.824

Generated 257 tokens in 2.73s. 
Token/sec: 94.18
Average acceptance length: 1.824
dataset: pg-19, length: 2048
Warming up GPUs...
Warmup complete!
len=2048:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=2048:   5%|███▊                                                                        | 1/20 [00:06<02:05,  6.61s/it]len=2048:  10%|███████▌                                                                    | 2/20 [00:12<01:53,  6.33s/it]len=2048:  15%|███████████▍                                                                | 3/20 [00:20<01:58,  6.97s/it]len=2048:  20%|███████████████▏                                                            | 4/20 [00:26<01:46,  6.68s/it]len=2048:  25%|███████████████████                                                         | 5/20 [00:32<01:37,  6.53s/it]len=2048:  30%|██████████████████████▊                                                     | 6/20 [00:39<01:30,  6.45s/it]len=2048:  35%|██████████████████████████▌                                                 | 7/20 [00:45<01:21,  6.24s/it]len=2048:  40%|██████████████████████████████▍                                             | 8/20 [00:51<01:13,  6.16s/it]len=2048:  45%|██████████████████████████████████▏                                         | 9/20 [00:58<01:13,  6.69s/it]len=2048:  50%|█████████████████████████████████████▌                                     | 10/20 [01:05<01:06,  6.68s/it]len=2048:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:12<01:00,  6.71s/it]len=2048:  60%|█████████████████████████████████████████████                              | 12/20 [01:18<00:51,  6.47s/it]len=2048:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:25<00:45,  6.56s/it]len=2048:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:32<00:41,  6.92s/it]len=2048:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:38<00:33,  6.63s/it]len=2048:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:45<00:27,  6.75s/it]len=2048:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:51<00:19,  6.56s/it]len=2048:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [01:57<00:12,  6.38s/it]len=2048:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [02:05<00:06,  6.69s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:11<00:00,  6.56s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:11<00:00,  6.58s/it]

Generated 260 tokens in 3.32s. 
Token/sec: 78.27
Average acceptance length: 1.708

Generated 258 tokens in 3.29s. 
Token/sec: 78.48
Average acceptance length: 1.716

Generated 257 tokens in 3.07s. 
Token/sec: 83.83
Average acceptance length: 1.888

Generated 257 tokens in 3.06s. 
Token/sec: 83.9
Average acceptance length: 1.888

Generated 258 tokens in 3.18s. 
Token/sec: 81.2
Average acceptance length: 1.774

Generated 258 tokens in 4.55s. 
Token/sec: 56.67
Average acceptance length: 1.774

Generated 258 tokens in 3.12s. 
Token/sec: 82.71
Average acceptance length: 1.835

Generated 258 tokens in 3.11s. 
Token/sec: 82.9
Average acceptance length: 1.835

Generated 257 tokens in 3.12s. 
Token/sec: 82.26
Average acceptance length: 1.856

Generated 257 tokens in 3.13s. 
Token/sec: 82.22
Average acceptance length: 1.856

Generated 258 tokens in 3.14s. 
Token/sec: 82.16
Average acceptance length: 1.716

Generated 258 tokens in 3.14s. 
Token/sec: 82.14
Average acceptance length: 1.716

Generated 258 tokens in 2.91s. 
Token/sec: 88.77
Average acceptance length: 2.000

Generated 258 tokens in 2.91s. 
Token/sec: 88.58
Average acceptance length: 2.000

Generated 257 tokens in 3.00s. 
Token/sec: 85.78
Average acceptance length: 1.988

Generated 257 tokens in 2.97s. 
Token/sec: 86.44
Average acceptance length: 1.988

Generated 259 tokens in 4.60s. 
Token/sec: 56.33
Average acceptance length: 1.726

Generated 259 tokens in 3.25s. 
Token/sec: 79.8
Average acceptance length: 1.726

Generated 258 tokens in 3.33s. 
Token/sec: 77.59
Average acceptance length: 1.688

Generated 258 tokens in 3.33s. 
Token/sec: 77.59
Average acceptance length: 1.688

Generated 259 tokens in 3.40s. 
Token/sec: 76.2
Average acceptance length: 1.564

Generated 259 tokens in 3.40s. 
Token/sec: 76.25
Average acceptance length: 1.564

Generated 258 tokens in 2.95s. 
Token/sec: 87.42
Average acceptance length: 2.035

Generated 258 tokens in 2.95s. 
Token/sec: 87.42
Average acceptance length: 2.035

Generated 259 tokens in 3.39s. 
Token/sec: 76.46
Average acceptance length: 1.539

Generated 259 tokens in 3.39s. 
Token/sec: 76.5
Average acceptance length: 1.539

Generated 257 tokens in 4.54s. 
Token/sec: 56.61
Average acceptance length: 1.734

Generated 257 tokens in 3.20s. 
Token/sec: 80.33
Average acceptance length: 1.734

Generated 260 tokens in 2.98s. 
Token/sec: 87.23
Average acceptance length: 1.955

Generated 260 tokens in 2.98s. 
Token/sec: 87.17
Average acceptance length: 1.955

Generated 259 tokens in 3.51s. 
Token/sec: 73.8
Average acceptance length: 1.490

Generated 259 tokens in 3.51s. 
Token/sec: 73.71
Average acceptance length: 1.490

Generated 257 tokens in 3.05s. 
Token/sec: 84.15
Average acceptance length: 1.920

Generated 257 tokens in 3.05s. 
Token/sec: 84.15
Average acceptance length: 1.920

Generated 257 tokens in 2.98s. 
Token/sec: 86.19
Average acceptance length: 1.920

Generated 257 tokens in 2.98s. 
Token/sec: 86.19
Average acceptance length: 1.920

Generated 257 tokens in 4.38s. 
Token/sec: 58.62
Average acceptance length: 1.920

Generated 257 tokens in 3.03s. 
Token/sec: 84.88
Average acceptance length: 1.920

Generated 259 tokens in 3.12s. 
Token/sec: 82.98
Average acceptance length: 1.698

Generated 259 tokens in 3.12s. 
Token/sec: 82.95
Average acceptance length: 1.698
dataset: pg-19, length: 4096
Warming up GPUs...
Warmup complete!
len=4096:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=4096:   5%|███▊                                                                        | 1/20 [00:09<03:01,  9.56s/it]len=4096:  10%|███████▌                                                                    | 2/20 [00:19<02:51,  9.54s/it]len=4096:  15%|███████████▍                                                                | 3/20 [00:30<02:56, 10.39s/it]len=4096:  20%|███████████████▏                                                            | 4/20 [00:40<02:43, 10.19s/it]len=4096:  25%|███████████████████                                                         | 5/20 [00:49<02:27,  9.84s/it]len=4096:  30%|██████████████████████▊                                                     | 6/20 [01:00<02:24, 10.30s/it]len=4096:  35%|██████████████████████████▌                                                 | 7/20 [01:10<02:10, 10.05s/it]len=4096:  40%|██████████████████████████████▍                                             | 8/20 [01:19<01:58,  9.91s/it]len=4096:  45%|██████████████████████████████████▏                                         | 9/20 [01:30<01:52, 10.27s/it]len=4096:  50%|█████████████████████████████████████▌                                     | 10/20 [01:40<01:41, 10.16s/it]len=4096:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:50<01:29, 10.00s/it]len=4096:  60%|█████████████████████████████████████████████                              | 12/20 [02:00<01:19,  9.89s/it]len=4096:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:10<01:10, 10.13s/it]len=4096:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:20<00:59,  9.83s/it]len=4096:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:30<00:50, 10.04s/it]len=4096:  80%|████████████████████████████████████████████████████████████               | 16/20 [02:41<00:41, 10.30s/it]len=4096:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [02:50<00:30, 10.07s/it]len=4096:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [03:01<00:20, 10.10s/it]len=4096:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:12<00:10, 10.55s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:22<00:00, 10.45s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:22<00:00, 10.15s/it]

Generated 259 tokens in 4.77s. 
Token/sec: 54.27
Average acceptance length: 1.106

Generated 259 tokens in 4.78s. 
Token/sec: 54.16
Average acceptance length: 1.106

Generated 257 tokens in 4.76s. 
Token/sec: 54.02
Average acceptance length: 1.040

Generated 257 tokens in 4.77s. 
Token/sec: 53.93
Average acceptance length: 1.040

Generated 257 tokens in 6.36s. 
Token/sec: 40.41
Average acceptance length: 0.977

Generated 257 tokens in 5.03s. 
Token/sec: 51.14
Average acceptance length: 0.977

Generated 257 tokens in 4.94s. 
Token/sec: 52.0
Average acceptance length: 1.008

Generated 257 tokens in 4.94s. 
Token/sec: 51.99
Average acceptance length: 1.008

Generated 257 tokens in 4.61s. 
Token/sec: 55.8
Average acceptance length: 1.197

Generated 257 tokens in 4.60s. 
Token/sec: 55.85
Average acceptance length: 1.197

Generated 257 tokens in 6.27s. 
Token/sec: 41.01
Average acceptance length: 1.024

Generated 257 tokens in 4.92s. 
Token/sec: 52.19
Average acceptance length: 1.024

Generated 259 tokens in 4.76s. 
Token/sec: 54.41
Average acceptance length: 1.089

Generated 259 tokens in 4.76s. 
Token/sec: 54.45
Average acceptance length: 1.089

Generated 258 tokens in 4.81s. 
Token/sec: 53.68
Average acceptance length: 1.098

Generated 258 tokens in 4.79s. 
Token/sec: 53.87
Average acceptance length: 1.098

Generated 259 tokens in 4.86s. 
Token/sec: 53.32
Average acceptance length: 1.056

Generated 259 tokens in 6.20s. 
Token/sec: 41.76
Average acceptance length: 1.056

Generated 257 tokens in 4.96s. 
Token/sec: 51.86
Average acceptance length: 1.008

Generated 257 tokens in 4.95s. 
Token/sec: 51.89
Average acceptance length: 1.008

Generated 258 tokens in 4.81s. 
Token/sec: 53.6
Average acceptance length: 1.098

Generated 258 tokens in 4.81s. 
Token/sec: 53.64
Average acceptance length: 1.098

Generated 258 tokens in 4.82s. 
Token/sec: 53.52
Average acceptance length: 1.081

Generated 258 tokens in 4.82s. 
Token/sec: 53.57
Average acceptance length: 1.081

Generated 258 tokens in 6.00s. 
Token/sec: 43.0
Average acceptance length: 1.168

Generated 258 tokens in 4.65s. 
Token/sec: 55.44
Average acceptance length: 1.168

Generated 257 tokens in 4.58s. 
Token/sec: 56.15
Average acceptance length: 1.160

Generated 257 tokens in 4.58s. 
Token/sec: 56.15
Average acceptance length: 1.160

Generated 257 tokens in 5.21s. 
Token/sec: 49.34
Average acceptance length: 0.904

Generated 257 tokens in 5.31s. 
Token/sec: 48.41
Average acceptance length: 0.904

Generated 258 tokens in 6.12s. 
Token/sec: 42.14
Average acceptance length: 1.064

Generated 258 tokens in 4.78s. 
Token/sec: 53.97
Average acceptance length: 1.064

Generated 257 tokens in 4.76s. 
Token/sec: 54.04
Average acceptance length: 1.107

Generated 257 tokens in 4.75s. 
Token/sec: 54.08
Average acceptance length: 1.107

Generated 258 tokens in 5.09s. 
Token/sec: 50.67
Average acceptance length: 0.969

Generated 258 tokens in 5.09s. 
Token/sec: 50.7
Average acceptance length: 0.969

Generated 257 tokens in 5.11s. 
Token/sec: 50.29
Average acceptance length: 0.932

Generated 257 tokens in 6.46s. 
Token/sec: 39.8
Average acceptance length: 0.932

Generated 258 tokens in 5.11s. 
Token/sec: 50.52
Average acceptance length: 0.940

Generated 258 tokens in 5.10s. 
Token/sec: 50.55
Average acceptance length: 0.940
dataset: pg-19, length: 8192
Warming up GPUs...
Warmup complete!
len=8192:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=8192:   5%|███▊                                                                        | 1/20 [00:14<04:36, 14.57s/it]len=8192:  10%|███████▌                                                                    | 2/20 [00:29<04:27, 14.86s/it]len=8192:  15%|███████████▍                                                                | 3/20 [00:42<03:58, 14.05s/it]len=8192:  20%|███████████████▏                                                            | 4/20 [00:57<03:51, 14.48s/it]len=8192:  25%|███████████████████                                                         | 5/20 [01:11<03:33, 14.20s/it]len=8192:  30%|██████████████████████▊                                                     | 6/20 [01:26<03:22, 14.49s/it]len=8192:  35%|██████████████████████████▌                                                 | 7/20 [01:40<03:06, 14.31s/it]len=8192:  40%|██████████████████████████████▍                                             | 8/20 [01:54<02:52, 14.34s/it]len=8192:  45%|██████████████████████████████████▏                                         | 9/20 [02:10<02:42, 14.79s/it]len=8192:  50%|█████████████████████████████████████▌                                     | 10/20 [02:25<02:26, 14.66s/it]len=8192:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:39<02:11, 14.62s/it]len=8192:  60%|█████████████████████████████████████████████                              | 12/20 [02:52<01:53, 14.23s/it]len=8192:  65%|████████████████████████████████████████████████▊                          | 13/20 [03:09<01:44, 14.88s/it]len=8192:  70%|████████████████████████████████████████████████████▌                      | 14/20 [03:24<01:29, 14.87s/it]len=8192:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [03:40<01:16, 15.30s/it]len=8192:  80%|████████████████████████████████████████████████████████████               | 16/20 [03:54<00:59, 14.88s/it]len=8192:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [04:08<00:43, 14.55s/it]len=8192:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [04:23<00:29, 14.84s/it]len=8192:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [04:37<00:14, 14.54s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [04:52<00:00, 14.79s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [04:52<00:00, 14.65s/it]

Generated 258 tokens in 7.29s. 
Token/sec: 35.4
Average acceptance length: 0.985

Generated 258 tokens in 7.27s. 
Token/sec: 35.51
Average acceptance length: 0.985

Generated 257 tokens in 8.19s. 
Token/sec: 31.38
Average acceptance length: 1.073

Generated 257 tokens in 6.85s. 
Token/sec: 37.54
Average acceptance length: 1.073

Generated 258 tokens in 6.53s. 
Token/sec: 39.5
Average acceptance length: 1.016

Generated 258 tokens in 6.53s. 
Token/sec: 39.49
Average acceptance length: 1.016

Generated 257 tokens in 8.24s. 
Token/sec: 31.2
Average acceptance length: 0.962

Generated 257 tokens in 6.90s. 
Token/sec: 37.25
Average acceptance length: 0.962

Generated 258 tokens in 6.84s. 
Token/sec: 37.7
Average acceptance length: 1.098

Generated 258 tokens in 6.84s. 
Token/sec: 37.7
Average acceptance length: 1.098

Generated 258 tokens in 6.85s. 
Token/sec: 37.65
Average acceptance length: 1.081

Generated 258 tokens in 8.19s. 
Token/sec: 31.49
Average acceptance length: 1.081

Generated 257 tokens in 6.96s. 
Token/sec: 36.92
Average acceptance length: 0.962

Generated 257 tokens in 6.96s. 
Token/sec: 36.9
Average acceptance length: 0.962

Generated 259 tokens in 7.19s. 
Token/sec: 36.01
Average acceptance length: 0.919

Generated 259 tokens in 7.19s. 
Token/sec: 36.03
Average acceptance length: 0.919

Generated 258 tokens in 8.56s. 
Token/sec: 30.15
Average acceptance length: 0.883

Generated 258 tokens in 7.22s. 
Token/sec: 35.76
Average acceptance length: 0.883

Generated 258 tokens in 7.17s. 
Token/sec: 35.97
Average acceptance length: 0.955

Generated 258 tokens in 7.17s. 
Token/sec: 35.96
Average acceptance length: 0.955

Generated 258 tokens in 7.93s. 
Token/sec: 32.52
Average acceptance length: 1.031

Generated 258 tokens in 6.59s. 
Token/sec: 39.17
Average acceptance length: 1.031

Generated 257 tokens in 6.65s. 
Token/sec: 38.62
Average acceptance length: 0.992

Generated 257 tokens in 6.66s. 
Token/sec: 38.58
Average acceptance length: 0.992

Generated 257 tokens in 7.49s. 
Token/sec: 34.32
Average acceptance length: 0.862

Generated 257 tokens in 8.86s. 
Token/sec: 29.0
Average acceptance length: 0.862

Generated 257 tokens in 7.41s. 
Token/sec: 34.67
Average acceptance length: 0.918

Generated 257 tokens in 7.41s. 
Token/sec: 34.67
Average acceptance length: 0.918

Generated 257 tokens in 7.48s. 
Token/sec: 34.37
Average acceptance length: 0.918

Generated 257 tokens in 8.81s. 
Token/sec: 29.16
Average acceptance length: 0.918

Generated 257 tokens in 6.96s. 
Token/sec: 36.95
Average acceptance length: 1.056

Generated 257 tokens in 6.91s. 
Token/sec: 37.2
Average acceptance length: 1.056

Generated 258 tokens in 6.91s. 
Token/sec: 37.31
Average acceptance length: 1.048

Generated 258 tokens in 6.84s. 
Token/sec: 37.71
Average acceptance length: 1.048

Generated 258 tokens in 8.42s. 
Token/sec: 30.64
Average acceptance length: 1.031

Generated 258 tokens in 7.08s. 
Token/sec: 36.44
Average acceptance length: 1.031

Generated 257 tokens in 6.92s. 
Token/sec: 37.14
Average acceptance length: 0.992

Generated 257 tokens in 6.92s. 
Token/sec: 37.14
Average acceptance length: 0.992

Generated 258 tokens in 8.35s. 
Token/sec: 30.88
Average acceptance length: 1.048

Generated 258 tokens in 7.01s. 
Token/sec: 36.82
Average acceptance length: 1.048
dataset: pg-19, length: 16000
Warming up GPUs...
Warmup complete!
len=16000:   0%|                                                                                   | 0/20 [00:00<?, ?it/s]len=16000:   5%|███▊                                                                       | 1/20 [00:22<06:59, 22.09s/it]len=16000:  10%|███████▌                                                                   | 2/20 [00:42<06:22, 21.23s/it]len=16000:  15%|███████████▎                                                               | 3/20 [01:04<06:04, 21.45s/it]len=16000:  20%|███████████████                                                            | 4/20 [01:27<05:51, 21.94s/it]len=16000:  25%|██████████████████▊                                                        | 5/20 [01:48<05:26, 21.75s/it]len=16000:  30%|██████████████████████▌                                                    | 6/20 [02:11<05:12, 22.32s/it]len=16000:  35%|██████████████████████████▎                                                | 7/20 [02:35<04:55, 22.73s/it]len=16000:  40%|██████████████████████████████                                             | 8/20 [02:57<04:30, 22.53s/it]len=16000:  45%|█████████████████████████████████▊                                         | 9/20 [03:20<04:08, 22.58s/it]len=16000:  50%|█████████████████████████████████████                                     | 10/20 [03:44<03:50, 23.05s/it]len=16000:  55%|████████████████████████████████████████▋                                 | 11/20 [04:06<03:23, 22.66s/it]len=16000:  60%|████████████████████████████████████████████▍                             | 12/20 [04:28<03:01, 22.64s/it]len=16000:  65%|████████████████████████████████████████████████                          | 13/20 [04:50<02:36, 22.40s/it]len=16000:  70%|███████████████████████████████████████████████████▊                      | 14/20 [05:12<02:12, 22.10s/it]len=16000:  75%|███████████████████████████████████████████████████████▌                  | 15/20 [05:36<01:53, 22.74s/it]len=16000:  80%|███████████████████████████████████████████████████████████▏              | 16/20 [05:59<01:31, 22.81s/it]len=16000:  85%|██████████████████████████████████████████████████████████████▉           | 17/20 [06:22<01:08, 22.89s/it]len=16000:  90%|██████████████████████████████████████████████████████████████████▌       | 18/20 [06:45<00:45, 22.87s/it]len=16000:  95%|██████████████████████████████████████████████████████████████████████▎   | 19/20 [07:08<00:23, 23.02s/it]len=16000: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [07:30<00:00, 22.65s/it]len=16000: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [07:30<00:00, 22.52s/it]

Generated 257 tokens in 10.37s. 
Token/sec: 24.79
Average acceptance length: 0.932

Generated 257 tokens in 11.69s. 
Token/sec: 21.98
Average acceptance length: 0.932

Generated 258 tokens in 10.30s. 
Token/sec: 25.04
Average acceptance length: 0.911

Generated 258 tokens in 10.30s. 
Token/sec: 25.05
Average acceptance length: 0.911

Generated 257 tokens in 11.51s. 
Token/sec: 22.33
Average acceptance length: 0.932

Generated 257 tokens in 10.17s. 
Token/sec: 25.27
Average acceptance length: 0.932

Generated 257 tokens in 10.65s. 
Token/sec: 24.13
Average acceptance length: 0.836

Generated 257 tokens in 12.02s. 
Token/sec: 21.38
Average acceptance length: 0.836

Generated 259 tokens in 10.68s. 
Token/sec: 24.25
Average acceptance length: 0.863

Generated 259 tokens in 10.68s. 
Token/sec: 24.24
Average acceptance length: 0.863

Generated 257 tokens in 12.36s. 
Token/sec: 20.79
Average acceptance length: 0.836

Generated 257 tokens in 11.04s. 
Token/sec: 23.29
Average acceptance length: 0.836

Generated 258 tokens in 11.13s. 
Token/sec: 23.18
Average acceptance length: 0.969

Generated 258 tokens in 12.40s. 
Token/sec: 20.81
Average acceptance length: 0.969

Generated 257 tokens in 11.05s. 
Token/sec: 23.26
Average acceptance length: 0.862

Generated 257 tokens in 11.04s. 
Token/sec: 23.29
Average acceptance length: 0.862

Generated 257 tokens in 11.98s. 
Token/sec: 21.45
Average acceptance length: 0.836

Generated 257 tokens in 10.66s. 
Token/sec: 24.1
Average acceptance length: 0.836

Generated 259 tokens in 11.36s. 
Token/sec: 22.8
Average acceptance length: 0.962

Generated 259 tokens in 12.72s. 
Token/sec: 20.37
Average acceptance length: 0.962

Generated 258 tokens in 10.86s. 
Token/sec: 23.77
Average acceptance length: 0.940

Generated 258 tokens in 10.87s. 
Token/sec: 23.73
Average acceptance length: 0.940

Generated 257 tokens in 11.95s. 
Token/sec: 21.51
Average acceptance length: 1.024

Generated 257 tokens in 10.62s. 
Token/sec: 24.19
Average acceptance length: 1.024

Generated 257 tokens in 10.22s. 
Token/sec: 25.14
Average acceptance length: 0.904

Generated 257 tokens in 11.59s. 
Token/sec: 22.18
Average acceptance length: 0.904

Generated 258 tokens in 10.71s. 
Token/sec: 24.1
Average acceptance length: 0.830

Generated 258 tokens in 10.68s. 
Token/sec: 24.16
Average acceptance length: 0.830

Generated 259 tokens in 12.75s. 
Token/sec: 20.31
Average acceptance length: 0.919

Generated 259 tokens in 11.41s. 
Token/sec: 22.69
Average acceptance length: 0.919

Generated 257 tokens in 10.79s. 
Token/sec: 23.82
Average acceptance length: 0.823

Generated 257 tokens in 12.13s. 
Token/sec: 21.18
Average acceptance length: 0.823

Generated 258 tokens in 11.53s. 
Token/sec: 22.37
Average acceptance length: 0.804

Generated 258 tokens in 11.52s. 
Token/sec: 22.4
Average acceptance length: 0.804

Generated 258 tokens in 12.08s. 
Token/sec: 21.36
Average acceptance length: 0.969

Generated 258 tokens in 10.72s. 
Token/sec: 24.08
Average acceptance length: 0.969

Generated 257 tokens in 11.00s. 
Token/sec: 23.37
Average acceptance length: 0.932

Generated 257 tokens in 12.34s. 
Token/sec: 20.83
Average acceptance length: 0.932

Generated 258 tokens in 10.88s. 
Token/sec: 23.71
Average acceptance length: 0.911

Generated 258 tokens in 10.88s. 
Token/sec: 23.72
Average acceptance length: 0.911
Experiment complete!
JSON decode error in .DS_Store line 0: Expecting value: line 1 column 1 (char 0)
Loading checkpoint shards:   0%|                                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|███████████████                                             | 1/4 [00:00<00:02,  1.40it/s]Loading checkpoint shards:  50%|██████████████████████████████                              | 2/4 [00:01<00:01,  1.40it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████               | 3/4 [00:02<00:00,  1.41it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.96it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.71it/s]
/home/hjkim/workspace/SpecExtend_Reb/eagle/model_eagle.py:105: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ea_layer_state_dict = torch.load(load_model_path,
Warming up GPUs...
Warmup complete!
dataset: booksum, length: 1024
Warming up GPUs...
Warmup complete!
len=1024:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=1024:   5%|███▊                                                                        | 1/20 [00:05<01:53,  5.97s/it]len=1024:  10%|███████▌                                                                    | 2/20 [00:12<01:48,  6.04s/it]len=1024:  15%|███████████▍                                                                | 3/20 [00:18<01:42,  6.03s/it]len=1024:  20%|███████████████▏                                                            | 4/20 [00:25<01:44,  6.56s/it]len=1024:  25%|███████████████████                                                         | 5/20 [00:31<01:35,  6.35s/it]len=1024:  30%|██████████████████████▊                                                     | 6/20 [00:37<01:27,  6.22s/it]len=1024:  35%|██████████████████████████▌                                                 | 7/20 [00:43<01:19,  6.14s/it]len=1024:  40%|██████████████████████████████▍                                             | 8/20 [00:49<01:13,  6.09s/it]len=1024:  45%|██████████████████████████████████▏                                         | 9/20 [00:55<01:05,  5.96s/it]len=1024:  50%|█████████████████████████████████████▌                                     | 10/20 [01:01<01:02,  6.23s/it]len=1024:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:07<00:54,  6.10s/it]len=1024:  60%|█████████████████████████████████████████████                              | 12/20 [01:13<00:47,  5.90s/it]len=1024:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:18<00:41,  5.88s/it]len=1024:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:24<00:34,  5.69s/it]len=1024:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:30<00:28,  5.79s/it]len=1024:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:37<00:24,  6.09s/it]len=1024:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:42<00:17,  5.83s/it]len=1024:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [01:47<00:11,  5.71s/it]len=1024:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [01:52<00:05,  5.58s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [01:58<00:00,  5.63s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [01:58<00:00,  5.93s/it]

Generated 257 tokens in 2.99s. 
Token/sec: 85.83
Average acceptance length: 1.495

Generated 257 tokens in 2.98s. 
Token/sec: 86.38
Average acceptance length: 1.495

Generated 257 tokens in 2.97s. 
Token/sec: 86.39
Average acceptance length: 1.495

Generated 257 tokens in 3.12s. 
Token/sec: 82.43
Average acceptance length: 1.495

Generated 257 tokens in 3.04s. 
Token/sec: 84.56
Average acceptance length: 1.495

Generated 257 tokens in 2.97s. 
Token/sec: 86.43
Average acceptance length: 1.495

Generated 257 tokens in 2.97s. 
Token/sec: 86.41
Average acceptance length: 1.495

Generated 257 tokens in 4.39s. 
Token/sec: 58.5
Average acceptance length: 1.495

Generated 257 tokens in 2.99s. 
Token/sec: 85.92
Average acceptance length: 1.520

Generated 257 tokens in 2.99s. 
Token/sec: 86.07
Average acceptance length: 1.520

Generated 257 tokens in 2.99s. 
Token/sec: 85.86
Average acceptance length: 1.520

Generated 257 tokens in 2.98s. 
Token/sec: 86.18
Average acceptance length: 1.520

Generated 257 tokens in 2.98s. 
Token/sec: 86.13
Average acceptance length: 1.520

Generated 257 tokens in 2.98s. 
Token/sec: 86.11
Average acceptance length: 1.520

Generated 257 tokens in 2.98s. 
Token/sec: 86.12
Average acceptance length: 1.520

Generated 257 tokens in 2.98s. 
Token/sec: 86.14
Average acceptance length: 1.520

Generated 259 tokens in 2.84s. 
Token/sec: 91.06
Average acceptance length: 1.726

Generated 259 tokens in 2.84s. 
Token/sec: 91.09
Average acceptance length: 1.726

Generated 257 tokens in 4.09s. 
Token/sec: 62.88
Average acceptance length: 1.856

Generated 257 tokens in 2.75s. 
Token/sec: 93.56
Average acceptance length: 1.856

Generated 258 tokens in 2.90s. 
Token/sec: 88.89
Average acceptance length: 1.688

Generated 258 tokens in 2.90s. 
Token/sec: 88.9
Average acceptance length: 1.688

Generated 259 tokens in 2.72s. 
Token/sec: 95.35
Average acceptance length: 1.943

Generated 259 tokens in 2.72s. 
Token/sec: 95.36
Average acceptance length: 1.943

Generated 261 tokens in 2.92s. 
Token/sec: 89.46
Average acceptance length: 1.747

Generated 261 tokens in 2.92s. 
Token/sec: 89.42
Average acceptance length: 1.747

Generated 257 tokens in 2.62s. 
Token/sec: 98.04
Average acceptance length: 2.024

Generated 257 tokens in 2.62s. 
Token/sec: 98.09
Average acceptance length: 2.024

Generated 258 tokens in 2.93s. 
Token/sec: 88.03
Average acceptance length: 1.660

Generated 258 tokens in 3.09s. 
Token/sec: 83.62
Average acceptance length: 1.660

Generated 257 tokens in 4.08s. 
Token/sec: 63.06
Average acceptance length: 1.920

Generated 257 tokens in 2.70s. 
Token/sec: 95.23
Average acceptance length: 1.920

Generated 258 tokens in 2.61s. 
Token/sec: 98.77
Average acceptance length: 2.108

Generated 258 tokens in 2.61s. 
Token/sec: 98.68
Average acceptance length: 2.108

Generated 257 tokens in 2.71s. 
Token/sec: 94.76
Average acceptance length: 1.888

Generated 257 tokens in 2.71s. 
Token/sec: 94.75
Average acceptance length: 1.888

Generated 258 tokens in 2.64s. 
Token/sec: 97.59
Average acceptance length: 2.000

Generated 258 tokens in 2.64s. 
Token/sec: 97.59
Average acceptance length: 2.000

Generated 259 tokens in 2.86s. 
Token/sec: 90.49
Average acceptance length: 1.726

Generated 259 tokens in 2.86s. 
Token/sec: 90.43
Average acceptance length: 1.726
dataset: booksum, length: 2048
Warming up GPUs...
Warmup complete!
len=2048:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=2048:   5%|███▊                                                                        | 1/20 [00:07<02:30,  7.92s/it]len=2048:  10%|███████▌                                                                    | 2/20 [00:14<02:11,  7.32s/it]len=2048:  15%|███████████▍                                                                | 3/20 [00:21<01:59,  7.05s/it]len=2048:  20%|███████████████▏                                                            | 4/20 [00:28<01:52,  7.04s/it]len=2048:  25%|███████████████████                                                         | 5/20 [00:35<01:45,  7.06s/it]len=2048:  30%|██████████████████████▊                                                     | 6/20 [00:44<01:45,  7.51s/it]len=2048:  35%|██████████████████████████▌                                                 | 7/20 [00:50<01:33,  7.16s/it]len=2048:  40%|██████████████████████████████▍                                             | 8/20 [00:56<01:23,  6.93s/it]len=2048:  45%|██████████████████████████████████▏                                         | 9/20 [01:04<01:17,  7.02s/it]len=2048:  50%|█████████████████████████████████████▌                                     | 10/20 [01:11<01:10,  7.08s/it]len=2048:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:20<01:08,  7.58s/it]len=2048:  60%|█████████████████████████████████████████████                              | 12/20 [01:27<00:59,  7.47s/it]len=2048:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:34<00:50,  7.24s/it]len=2048:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:40<00:42,  7.09s/it]len=2048:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:48<00:36,  7.39s/it]len=2048:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:55<00:28,  7.19s/it]len=2048:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [02:02<00:21,  7.05s/it]len=2048:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [02:08<00:13,  6.88s/it]len=2048:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [02:15<00:06,  6.79s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:23<00:00,  7.05s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:23<00:00,  7.15s/it]

Generated 258 tokens in 3.32s. 
Token/sec: 77.78
Average acceptance length: 1.606

Generated 259 tokens in 4.60s. 
Token/sec: 56.36
Average acceptance length: 1.698

Generated 258 tokens in 3.39s. 
Token/sec: 76.02
Average acceptance length: 1.580

Generated 258 tokens in 3.50s. 
Token/sec: 73.74
Average acceptance length: 1.580

Generated 258 tokens in 3.36s. 
Token/sec: 76.74
Average acceptance length: 1.580

Generated 258 tokens in 3.36s. 
Token/sec: 76.75
Average acceptance length: 1.580

Generated 258 tokens in 3.39s. 
Token/sec: 76.1
Average acceptance length: 1.580

Generated 258 tokens in 3.62s. 
Token/sec: 71.22
Average acceptance length: 1.580

Generated 257 tokens in 3.57s. 
Token/sec: 71.94
Average acceptance length: 1.448

Generated 257 tokens in 3.51s. 
Token/sec: 73.16
Average acceptance length: 1.448

Generated 257 tokens in 4.86s. 
Token/sec: 52.89
Average acceptance length: 1.448

Generated 257 tokens in 3.51s. 
Token/sec: 73.15
Average acceptance length: 1.448

Generated 258 tokens in 3.22s. 
Token/sec: 80.22
Average acceptance length: 1.745

Generated 258 tokens in 3.21s. 
Token/sec: 80.28
Average acceptance length: 1.745

Generated 257 tokens in 3.23s. 
Token/sec: 79.63
Average acceptance length: 1.763

Generated 257 tokens in 3.23s. 
Token/sec: 79.59
Average acceptance length: 1.763

Generated 259 tokens in 3.61s. 
Token/sec: 71.76
Average acceptance length: 1.421

Generated 259 tokens in 3.60s. 
Token/sec: 71.85
Average acceptance length: 1.421

Generated 259 tokens in 3.61s. 
Token/sec: 71.84
Average acceptance length: 1.421

Generated 259 tokens in 3.61s. 
Token/sec: 71.83
Average acceptance length: 1.421

Generated 259 tokens in 5.07s. 
Token/sec: 51.11
Average acceptance length: 1.421

Generated 259 tokens in 3.63s. 
Token/sec: 71.34
Average acceptance length: 1.421

Generated 259 tokens in 3.60s. 
Token/sec: 71.89
Average acceptance length: 1.421

Generated 259 tokens in 3.60s. 
Token/sec: 71.89
Average acceptance length: 1.421

Generated 259 tokens in 3.36s. 
Token/sec: 77.04
Average acceptance length: 1.564

Generated 259 tokens in 3.36s. 
Token/sec: 77.06
Average acceptance length: 1.564

Generated 259 tokens in 3.36s. 
Token/sec: 77.04
Average acceptance length: 1.564

Generated 259 tokens in 3.38s. 
Token/sec: 76.73
Average acceptance length: 1.564

Generated 259 tokens in 3.36s. 
Token/sec: 77.01
Average acceptance length: 1.564

Generated 259 tokens in 4.70s. 
Token/sec: 55.07
Average acceptance length: 1.564

Generated 259 tokens in 3.36s. 
Token/sec: 77.0
Average acceptance length: 1.564

Generated 259 tokens in 3.36s. 
Token/sec: 77.04
Average acceptance length: 1.564

Generated 259 tokens in 3.36s. 
Token/sec: 77.01
Average acceptance length: 1.564

Generated 259 tokens in 3.36s. 
Token/sec: 77.02
Average acceptance length: 1.564

Generated 259 tokens in 3.23s. 
Token/sec: 80.17
Average acceptance length: 1.726

Generated 259 tokens in 3.23s. 
Token/sec: 80.15
Average acceptance length: 1.726

Generated 258 tokens in 3.29s. 
Token/sec: 78.38
Average acceptance length: 1.660

Generated 258 tokens in 3.29s. 
Token/sec: 78.33
Average acceptance length: 1.660

Generated 257 tokens in 3.16s. 
Token/sec: 81.35
Average acceptance length: 1.793

Generated 257 tokens in 4.51s. 
Token/sec: 57.01
Average acceptance length: 1.793
dataset: booksum, length: 4096
Warming up GPUs...
Warmup complete!
len=4096:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=4096:   5%|███▊                                                                        | 1/20 [00:09<02:58,  9.38s/it]len=4096:  10%|███████▌                                                                    | 2/20 [00:18<02:45,  9.21s/it]len=4096:  15%|███████████▍                                                                | 3/20 [00:27<02:35,  9.16s/it]len=4096:  20%|███████████████▏                                                            | 4/20 [00:38<02:34,  9.67s/it]len=4096:  25%|███████████████████                                                         | 5/20 [00:47<02:21,  9.46s/it]len=4096:  30%|██████████████████████▊                                                     | 6/20 [00:56<02:10,  9.34s/it]len=4096:  35%|██████████████████████████▌                                                 | 7/20 [01:07<02:09,  9.94s/it]len=4096:  40%|██████████████████████████████▍                                             | 8/20 [01:17<01:59,  9.99s/it]len=4096:  45%|██████████████████████████████████▏                                         | 9/20 [01:27<01:50, 10.03s/it]len=4096:  50%|█████████████████████████████████████▌                                     | 10/20 [01:39<01:44, 10.48s/it]len=4096:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:49<01:33, 10.37s/it]len=4096:  60%|█████████████████████████████████████████████                              | 12/20 [01:58<01:21, 10.18s/it]len=4096:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:08<01:10, 10.01s/it]len=4096:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:19<01:01, 10.30s/it]len=4096:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:28<00:48,  9.76s/it]len=4096:  80%|████████████████████████████████████████████████████████████               | 16/20 [02:37<00:38,  9.71s/it]len=4096:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [02:48<00:30, 10.09s/it]len=4096:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [02:58<00:19,  9.94s/it]len=4096:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:07<00:09,  9.84s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:18<00:00, 10.17s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:18<00:00,  9.94s/it]

Generated 258 tokens in 4.68s. 
Token/sec: 55.08
Average acceptance length: 1.186

Generated 258 tokens in 4.68s. 
Token/sec: 55.08
Average acceptance length: 1.186

Generated 257 tokens in 4.54s. 
Token/sec: 56.56
Average acceptance length: 1.254

Generated 257 tokens in 4.54s. 
Token/sec: 56.57
Average acceptance length: 1.254

Generated 257 tokens in 4.54s. 
Token/sec: 56.55
Average acceptance length: 1.254

Generated 257 tokens in 4.54s. 
Token/sec: 56.59
Average acceptance length: 1.254

Generated 257 tokens in 5.90s. 
Token/sec: 43.55
Average acceptance length: 1.254

Generated 257 tokens in 4.55s. 
Token/sec: 56.55
Average acceptance length: 1.254

Generated 257 tokens in 4.54s. 
Token/sec: 56.58
Average acceptance length: 1.254

Generated 257 tokens in 4.54s. 
Token/sec: 56.55
Average acceptance length: 1.254

Generated 257 tokens in 4.54s. 
Token/sec: 56.57
Average acceptance length: 1.254

Generated 257 tokens in 4.54s. 
Token/sec: 56.55
Average acceptance length: 1.254

Generated 257 tokens in 4.92s. 
Token/sec: 52.19
Average acceptance length: 1.008

Generated 257 tokens in 6.26s. 
Token/sec: 41.07
Average acceptance length: 1.008

Generated 257 tokens in 5.05s. 
Token/sec: 50.9
Average acceptance length: 0.962

Generated 257 tokens in 5.04s. 
Token/sec: 50.95
Average acceptance length: 0.962

Generated 257 tokens in 5.06s. 
Token/sec: 50.82
Average acceptance length: 0.962

Generated 257 tokens in 5.05s. 
Token/sec: 50.92
Average acceptance length: 0.962

Generated 257 tokens in 5.05s. 
Token/sec: 50.89
Average acceptance length: 0.962

Generated 257 tokens in 6.44s. 
Token/sec: 39.91
Average acceptance length: 0.962

Generated 257 tokens in 5.05s. 
Token/sec: 50.89
Average acceptance length: 0.962

Generated 257 tokens in 5.05s. 
Token/sec: 50.91
Average acceptance length: 0.962

Generated 257 tokens in 4.87s. 
Token/sec: 52.75
Average acceptance length: 1.024

Generated 257 tokens in 4.87s. 
Token/sec: 52.74
Average acceptance length: 1.024

Generated 257 tokens in 4.81s. 
Token/sec: 53.46
Average acceptance length: 1.056

Generated 257 tokens in 4.81s. 
Token/sec: 53.47
Average acceptance length: 1.056

Generated 257 tokens in 6.15s. 
Token/sec: 41.82
Average acceptance length: 1.056

Generated 257 tokens in 4.81s. 
Token/sec: 53.45
Average acceptance length: 1.056

Generated 258 tokens in 4.25s. 
Token/sec: 60.65
Average acceptance length: 1.411

Generated 258 tokens in 4.26s. 
Token/sec: 60.62
Average acceptance length: 1.411

Generated 257 tokens in 4.80s. 
Token/sec: 53.52
Average acceptance length: 1.124

Generated 257 tokens in 4.79s. 
Token/sec: 53.62
Average acceptance length: 1.124

Generated 257 tokens in 4.80s. 
Token/sec: 53.58
Average acceptance length: 1.124

Generated 257 tokens in 6.15s. 
Token/sec: 41.81
Average acceptance length: 1.124

Generated 257 tokens in 4.80s. 
Token/sec: 53.5
Average acceptance length: 1.124

Generated 257 tokens in 4.80s. 
Token/sec: 53.57
Average acceptance length: 1.124

Generated 257 tokens in 4.80s. 
Token/sec: 53.59
Average acceptance length: 1.124

Generated 257 tokens in 4.79s. 
Token/sec: 53.64
Average acceptance length: 1.124

Generated 257 tokens in 4.80s. 
Token/sec: 53.5
Average acceptance length: 1.124

Generated 257 tokens in 6.14s. 
Token/sec: 41.86
Average acceptance length: 1.124
dataset: booksum, length: 8192
Warming up GPUs...
Warmup complete!
len=8192:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=8192:   5%|███▊                                                                        | 1/20 [00:14<04:43, 14.94s/it]len=8192:  10%|███████▌                                                                    | 2/20 [00:31<04:42, 15.72s/it]len=8192:  15%|███████████▍                                                                | 3/20 [00:46<04:20, 15.33s/it]len=8192:  20%|███████████████▏                                                            | 4/20 [01:00<04:01, 15.07s/it]len=8192:  25%|███████████████████                                                         | 5/20 [01:16<03:51, 15.43s/it]len=8192:  30%|██████████████████████▊                                                     | 6/20 [01:31<03:31, 15.10s/it]len=8192:  35%|██████████████████████████▌                                                 | 7/20 [01:47<03:19, 15.34s/it]len=8192:  40%|██████████████████████████████▍                                             | 8/20 [02:01<03:00, 15.06s/it]len=8192:  45%|██████████████████████████████████▏                                         | 9/20 [02:17<02:47, 15.24s/it]len=8192:  50%|█████████████████████████████████████▌                                     | 10/20 [02:31<02:29, 14.99s/it]len=8192:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:47<02:16, 15.13s/it]len=8192:  60%|█████████████████████████████████████████████                              | 12/20 [03:01<02:00, 15.01s/it]len=8192:  65%|████████████████████████████████████████████████▊                          | 13/20 [03:17<01:47, 15.31s/it]len=8192:  70%|████████████████████████████████████████████████████▌                      | 14/20 [03:32<01:30, 15.11s/it]len=8192:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [03:46<01:14, 14.82s/it]len=8192:  80%|████████████████████████████████████████████████████████████               | 16/20 [04:03<01:01, 15.30s/it]len=8192:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [04:17<00:45, 15.01s/it]len=8192:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [04:33<00:30, 15.21s/it]len=8192:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [04:47<00:14, 14.87s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:03<00:00, 15.21s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:03<00:00, 15.16s/it]

Generated 258 tokens in 7.46s. 
Token/sec: 34.59
Average acceptance length: 0.843

Generated 258 tokens in 7.46s. 
Token/sec: 34.58
Average acceptance length: 0.843

Generated 258 tokens in 7.44s. 
Token/sec: 34.67
Average acceptance length: 0.843

Generated 258 tokens in 8.81s. 
Token/sec: 29.29
Average acceptance length: 0.843

Generated 258 tokens in 7.44s. 
Token/sec: 34.67
Average acceptance length: 0.856

Generated 258 tokens in 7.41s. 
Token/sec: 34.81
Average acceptance length: 0.856

Generated 259 tokens in 7.33s. 
Token/sec: 35.35
Average acceptance length: 0.933

Generated 259 tokens in 7.33s. 
Token/sec: 35.34
Average acceptance length: 0.933

Generated 258 tokens in 8.69s. 
Token/sec: 29.68
Average acceptance length: 0.925

Generated 258 tokens in 7.35s. 
Token/sec: 35.11
Average acceptance length: 0.925

Generated 257 tokens in 7.22s. 
Token/sec: 35.58
Average acceptance length: 0.962

Generated 257 tokens in 7.22s. 
Token/sec: 35.6
Average acceptance length: 0.962

Generated 257 tokens in 8.59s. 
Token/sec: 29.94
Average acceptance length: 0.962

Generated 257 tokens in 7.23s. 
Token/sec: 35.55
Average acceptance length: 0.962

Generated 257 tokens in 7.22s. 
Token/sec: 35.59
Average acceptance length: 0.962

Generated 257 tokens in 7.22s. 
Token/sec: 35.6
Average acceptance length: 0.962

Generated 257 tokens in 7.16s. 
Token/sec: 35.91
Average acceptance length: 0.962

Generated 257 tokens in 8.48s. 
Token/sec: 30.3
Average acceptance length: 0.962

Generated 257 tokens in 7.20s. 
Token/sec: 35.7
Average acceptance length: 0.947

Generated 257 tokens in 7.19s. 
Token/sec: 35.72
Average acceptance length: 0.947

Generated 257 tokens in 7.04s. 
Token/sec: 36.51
Average acceptance length: 0.992

Generated 257 tokens in 8.39s. 
Token/sec: 30.63
Average acceptance length: 0.992

Generated 259 tokens in 7.35s. 
Token/sec: 35.23
Average acceptance length: 0.962

Generated 259 tokens in 7.36s. 
Token/sec: 35.17
Average acceptance length: 0.962

Generated 257 tokens in 7.31s. 
Token/sec: 35.14
Average acceptance length: 0.890

Generated 257 tokens in 8.68s. 
Token/sec: 29.6
Average acceptance length: 0.890

Generated 257 tokens in 7.30s. 
Token/sec: 35.19
Average acceptance length: 0.947

Generated 257 tokens in 7.30s. 
Token/sec: 35.19
Average acceptance length: 0.947

Generated 258 tokens in 7.05s. 
Token/sec: 36.57
Average acceptance length: 1.031

Generated 258 tokens in 7.09s. 
Token/sec: 36.38
Average acceptance length: 1.031

Generated 257 tokens in 8.89s. 
Token/sec: 28.9
Average acceptance length: 0.876

Generated 257 tokens in 7.49s. 
Token/sec: 34.3
Average acceptance length: 0.876

Generated 258 tokens in 7.18s. 
Token/sec: 35.94
Average acceptance length: 0.969

Generated 258 tokens in 7.14s. 
Token/sec: 36.11
Average acceptance length: 0.969

Generated 258 tokens in 8.48s. 
Token/sec: 30.42
Average acceptance length: 0.969

Generated 258 tokens in 7.15s. 
Token/sec: 36.07
Average acceptance length: 0.969

Generated 258 tokens in 7.05s. 
Token/sec: 36.59
Average acceptance length: 1.031

Generated 258 tokens in 7.00s. 
Token/sec: 36.83
Average acceptance length: 1.031

Generated 257 tokens in 7.32s. 
Token/sec: 35.09
Average acceptance length: 0.947

Generated 257 tokens in 8.66s. 
Token/sec: 29.68
Average acceptance length: 0.947
dataset: booksum, length: 16384
Warming up GPUs...
Warmup complete!
len=16384:   0%|                                                                                   | 0/20 [00:00<?, ?it/s]len=16384:   5%|███▊                                                                       | 1/20 [00:23<07:30, 23.71s/it]len=16384:  10%|███████▌                                                                   | 2/20 [00:47<07:04, 23.58s/it]len=16384:  15%|███████████▎                                                               | 3/20 [01:10<06:40, 23.57s/it]len=16384:  20%|███████████████                                                            | 4/20 [01:34<06:17, 23.62s/it]len=16384:  25%|██████████████████▊                                                        | 5/20 [01:56<05:46, 23.12s/it]len=16384:  30%|██████████████████████▌                                                    | 6/20 [02:20<05:25, 23.22s/it]len=16384:  35%|██████████████████████████▎                                                | 7/20 [02:44<05:08, 23.76s/it]len=16384:  40%|██████████████████████████████                                             | 8/20 [03:09<04:48, 24.07s/it]len=16384:  45%|█████████████████████████████████▊                                         | 9/20 [03:33<04:23, 24.00s/it]len=16384:  50%|█████████████████████████████████████                                     | 10/20 [03:58<04:03, 24.35s/it]len=16384:  55%|████████████████████████████████████████▋                                 | 11/20 [04:24<03:42, 24.71s/it]len=16384:  60%|████████████████████████████████████████████▍                             | 12/20 [04:50<03:20, 25.08s/it]len=16384:  65%|████████████████████████████████████████████████                          | 13/20 [05:13<02:52, 24.67s/it]len=16384:  70%|███████████████████████████████████████████████████▊                      | 14/20 [05:38<02:28, 24.67s/it]len=16384:  75%|███████████████████████████████████████████████████████▌                  | 15/20 [06:03<02:03, 24.68s/it]len=16384:  80%|███████████████████████████████████████████████████████████▏              | 16/20 [06:26<01:36, 24.23s/it]len=16384:  85%|██████████████████████████████████████████████████████████████▉           | 17/20 [06:50<01:12, 24.23s/it]len=16384:  90%|██████████████████████████████████████████████████████████████████▌       | 18/20 [07:16<00:49, 24.58s/it]len=16384:  95%|██████████████████████████████████████████████████████████████████████▎   | 19/20 [07:40<00:24, 24.54s/it]len=16384: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [08:04<00:00, 24.36s/it]len=16384: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [08:04<00:00, 24.22s/it]

Generated 258 tokens in 11.16s. 
Token/sec: 23.11
Average acceptance length: 0.925

Generated 258 tokens in 12.52s. 
Token/sec: 20.61
Average acceptance length: 0.925

Generated 257 tokens in 11.73s. 
Token/sec: 21.92
Average acceptance length: 0.797

Generated 257 tokens in 11.72s. 
Token/sec: 21.92
Average acceptance length: 0.797

Generated 257 tokens in 12.44s. 
Token/sec: 20.66
Average acceptance length: 0.947

Generated 257 tokens in 11.08s. 
Token/sec: 23.19
Average acceptance length: 0.947

Generated 257 tokens in 11.19s. 
Token/sec: 22.96
Average acceptance length: 0.876

Generated 257 tokens in 12.46s. 
Token/sec: 20.63
Average acceptance length: 0.876

Generated 257 tokens in 11.12s. 
Token/sec: 23.12
Average acceptance length: 0.876

Generated 257 tokens in 11.08s. 
Token/sec: 23.2
Average acceptance length: 0.876

Generated 257 tokens in 12.37s. 
Token/sec: 20.77
Average acceptance length: 0.962

Generated 257 tokens in 11.02s. 
Token/sec: 23.33
Average acceptance length: 0.962

Generated 258 tokens in 11.74s. 
Token/sec: 21.98
Average acceptance length: 0.830

Generated 258 tokens in 13.09s. 
Token/sec: 19.71
Average acceptance length: 0.830

Generated 257 tokens in 11.66s. 
Token/sec: 22.04
Average acceptance length: 0.810

Generated 257 tokens in 13.04s. 
Token/sec: 19.71
Average acceptance length: 0.810

Generated 258 tokens in 11.87s. 
Token/sec: 21.73
Average acceptance length: 0.856

Generated 258 tokens in 11.92s. 
Token/sec: 21.65
Average acceptance length: 0.856

Generated 257 tokens in 13.16s. 
Token/sec: 19.53
Average acceptance length: 0.890

Generated 257 tokens in 11.93s. 
Token/sec: 21.54
Average acceptance length: 0.890

Generated 257 tokens in 12.03s. 
Token/sec: 21.36
Average acceptance length: 0.797

Generated 257 tokens in 13.44s. 
Token/sec: 19.12
Average acceptance length: 0.797

Generated 257 tokens in 12.27s. 
Token/sec: 20.94
Average acceptance length: 0.748

Generated 257 tokens in 13.62s. 
Token/sec: 18.87
Average acceptance length: 0.748

Generated 257 tokens in 11.85s. 
Token/sec: 21.7
Average acceptance length: 0.876

Generated 257 tokens in 11.84s. 
Token/sec: 21.71
Average acceptance length: 0.876

Generated 258 tokens in 13.00s. 
Token/sec: 19.84
Average acceptance length: 0.883

Generated 258 tokens in 11.65s. 
Token/sec: 22.15
Average acceptance length: 0.883

Generated 258 tokens in 11.68s. 
Token/sec: 22.09
Average acceptance length: 0.870

Generated 258 tokens in 12.98s. 
Token/sec: 19.88
Average acceptance length: 0.870

Generated 258 tokens in 11.57s. 
Token/sec: 22.3
Average acceptance length: 0.911

Generated 258 tokens in 11.58s. 
Token/sec: 22.28
Average acceptance length: 0.911

Generated 257 tokens in 12.77s. 
Token/sec: 20.13
Average acceptance length: 0.918

Generated 257 tokens in 11.41s. 
Token/sec: 22.53
Average acceptance length: 0.918

Generated 257 tokens in 13.37s. 
Token/sec: 19.23
Average acceptance length: 0.797

Generated 257 tokens in 12.00s. 
Token/sec: 21.42
Average acceptance length: 0.797

Generated 258 tokens in 11.56s. 
Token/sec: 22.31
Average acceptance length: 0.911

Generated 258 tokens in 12.86s. 
Token/sec: 20.07
Average acceptance length: 0.911

Generated 257 tokens in 11.92s. 
Token/sec: 21.56
Average acceptance length: 0.823

Generated 257 tokens in 11.99s. 
Token/sec: 21.44
Average acceptance length: 0.823
Experiment complete!
Loading checkpoint shards:   0%|                                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|███████████████                                             | 1/4 [00:00<00:02,  1.39it/s]Loading checkpoint shards:  50%|██████████████████████████████                              | 2/4 [00:01<00:01,  1.39it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████               | 3/4 [00:03<00:01,  1.33s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:03<00:00,  1.13it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:03<00:00,  1.08it/s]
/home/hjkim/workspace/SpecExtend_Reb/eagle_3/model_eagle.py:109: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ea_layer_state_dict = torch.load(load_model_path,
Warming up GPUs...
Warmup complete!
len=1024:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=1024:   5%|███▊                                                                        | 1/20 [00:04<01:25,  4.50s/it]len=1024:  10%|███████▌                                                                    | 2/20 [00:09<01:26,  4.83s/it]len=1024:  15%|███████████▍                                                                | 3/20 [00:14<01:19,  4.68s/it]len=1024:  20%|███████████████▏                                                            | 4/20 [00:18<01:14,  4.64s/it]len=1024:  25%|███████████████████                                                         | 5/20 [00:22<01:06,  4.46s/it]len=1024:  30%|██████████████████████▊                                                     | 6/20 [00:28<01:08,  4.92s/it]len=1024:  35%|██████████████████████████▌                                                 | 7/20 [00:33<01:04,  4.95s/it]len=1024:  40%|██████████████████████████████▍                                             | 8/20 [00:38<00:59,  4.93s/it]len=1024:  45%|██████████████████████████████████▏                                         | 9/20 [00:43<00:54,  4.99s/it]len=1024:  50%|█████████████████████████████████████▌                                     | 10/20 [00:48<00:50,  5.01s/it]len=1024:  55%|█████████████████████████████████████████▎                                 | 11/20 [00:52<00:42,  4.78s/it]len=1024:  60%|█████████████████████████████████████████████                              | 12/20 [00:57<00:38,  4.76s/it]len=1024:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:04<00:36,  5.27s/it]len=1024:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:09<00:31,  5.26s/it]len=1024:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:14<00:25,  5.13s/it]len=1024:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:18<00:20,  5.00s/it]len=1024:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:23<00:14,  4.78s/it]len=1024:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [01:27<00:09,  4.78s/it]len=1024:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [01:34<00:05,  5.32s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [01:38<00:00,  5.07s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [01:38<00:00,  4.95s/it]

Generated 257 tokens in 2.25s. 
Token/sec: 114.0
Average acceptance length: 2.338

Generated 257 tokens in 2.25s. 
Token/sec: 114.38
Average acceptance length: 2.338

Generated 258 tokens in 2.53s. 
Token/sec: 102.17
Average acceptance length: 1.932

Generated 258 tokens in 2.53s. 
Token/sec: 102.14
Average acceptance length: 1.932

Generated 258 tokens in 2.25s. 
Token/sec: 114.53
Average acceptance length: 2.351

Generated 258 tokens in 2.25s. 
Token/sec: 114.58
Average acceptance length: 2.351

Generated 257 tokens in 2.29s. 
Token/sec: 112.31
Average acceptance length: 2.338

Generated 257 tokens in 2.29s. 
Token/sec: 112.41
Average acceptance length: 2.338

Generated 258 tokens in 2.06s. 
Token/sec: 125.06
Average acceptance length: 2.739

Generated 258 tokens in 2.06s. 
Token/sec: 125.22
Average acceptance length: 2.739

Generated 258 tokens in 3.58s. 
Token/sec: 72.01
Average acceptance length: 2.351

Generated 258 tokens in 2.25s. 
Token/sec: 114.68
Average acceptance length: 2.351

Generated 257 tokens in 2.49s. 
Token/sec: 103.32
Average acceptance length: 1.954

Generated 257 tokens in 2.51s. 
Token/sec: 102.56
Average acceptance length: 1.954

Generated 260 tokens in 2.44s. 
Token/sec: 106.54
Average acceptance length: 2.059

Generated 260 tokens in 2.44s. 
Token/sec: 106.56
Average acceptance length: 2.059

Generated 259 tokens in 2.56s. 
Token/sec: 101.14
Average acceptance length: 1.910

Generated 259 tokens in 2.56s. 
Token/sec: 101.07
Average acceptance length: 1.910

Generated 258 tokens in 2.53s. 
Token/sec: 102.04
Average acceptance length: 1.932

Generated 258 tokens in 2.53s. 
Token/sec: 102.06
Average acceptance length: 1.932

Generated 258 tokens in 2.12s. 
Token/sec: 121.71
Average acceptance length: 2.634

Generated 258 tokens in 2.12s. 
Token/sec: 121.77
Average acceptance length: 2.634

Generated 258 tokens in 2.36s. 
Token/sec: 109.42
Average acceptance length: 2.185

Generated 258 tokens in 2.36s. 
Token/sec: 109.38
Average acceptance length: 2.185

Generated 258 tokens in 3.91s. 
Token/sec: 66.03
Average acceptance length: 1.932

Generated 258 tokens in 2.55s. 
Token/sec: 101.32
Average acceptance length: 1.932

Generated 257 tokens in 2.65s. 
Token/sec: 97.0
Average acceptance length: 1.988

Generated 257 tokens in 2.57s. 
Token/sec: 99.99
Average acceptance length: 1.988

Generated 260 tokens in 2.41s. 
Token/sec: 107.71
Average acceptance length: 2.133

Generated 260 tokens in 2.41s. 
Token/sec: 107.67
Average acceptance length: 2.133

Generated 260 tokens in 2.35s. 
Token/sec: 110.45
Average acceptance length: 2.250

Generated 260 tokens in 2.36s. 
Token/sec: 110.33
Average acceptance length: 2.250

Generated 258 tokens in 2.11s. 
Token/sec: 122.29
Average acceptance length: 2.634

Generated 258 tokens in 2.15s. 
Token/sec: 120.03
Average acceptance length: 2.634

Generated 257 tokens in 2.39s. 
Token/sec: 107.4
Average acceptance length: 2.134

Generated 257 tokens in 2.38s. 
Token/sec: 107.83
Average acceptance length: 2.134

Generated 257 tokens in 2.61s. 
Token/sec: 98.53
Average acceptance length: 1.824

Generated 257 tokens in 3.95s. 
Token/sec: 65.02
Average acceptance length: 1.824

Generated 257 tokens in 2.24s. 
Token/sec: 114.6
Average acceptance length: 2.338

Generated 257 tokens in 2.24s. 
Token/sec: 114.5
Average acceptance length: 2.338
Warming up GPUs...
Warmup complete!
len=2048:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=2048:   5%|███▊                                                                        | 1/20 [00:05<01:42,  5.40s/it]len=2048:  10%|███████▌                                                                    | 2/20 [00:10<01:30,  5.03s/it]len=2048:  15%|███████████▍                                                                | 3/20 [00:15<01:29,  5.28s/it]len=2048:  20%|███████████████▏                                                            | 4/20 [00:22<01:32,  5.75s/it]len=2048:  25%|███████████████████                                                         | 5/20 [00:29<01:35,  6.36s/it]len=2048:  30%|██████████████████████▊                                                     | 6/20 [00:34<01:24,  6.01s/it]len=2048:  35%|██████████████████████████▌                                                 | 7/20 [00:40<01:14,  5.74s/it]len=2048:  40%|██████████████████████████████▍                                             | 8/20 [00:45<01:07,  5.59s/it]len=2048:  45%|██████████████████████████████████▏                                         | 9/20 [00:50<01:00,  5.54s/it]len=2048:  50%|█████████████████████████████████████▌                                     | 10/20 [00:56<00:54,  5.48s/it]len=2048:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:03<00:53,  5.97s/it]len=2048:  60%|█████████████████████████████████████████████                              | 12/20 [01:08<00:46,  5.83s/it]len=2048:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:14<00:39,  5.70s/it]len=2048:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:19<00:33,  5.58s/it]len=2048:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:25<00:27,  5.57s/it]len=2048:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:30<00:22,  5.66s/it]len=2048:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:38<00:18,  6.11s/it]len=2048:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [01:43<00:12,  6.01s/it]len=2048:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [01:49<00:05,  5.84s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [01:54<00:00,  5.59s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [01:54<00:00,  5.72s/it]

Generated 258 tokens in 2.68s. 
Token/sec: 96.23
Average acceptance length: 2.185

Generated 258 tokens in 2.71s. 
Token/sec: 95.12
Average acceptance length: 2.146

Generated 262 tokens in 2.39s. 
Token/sec: 109.79
Average acceptance length: 2.743

Generated 262 tokens in 2.39s. 
Token/sec: 109.71
Average acceptance length: 2.743

Generated 258 tokens in 2.86s. 
Token/sec: 90.19
Average acceptance length: 2.108

Generated 258 tokens in 2.71s. 
Token/sec: 95.1
Average acceptance length: 2.108

Generated 259 tokens in 3.24s. 
Token/sec: 80.0
Average acceptance length: 1.564

Generated 259 tokens in 3.23s. 
Token/sec: 80.11
Average acceptance length: 1.564

Generated 257 tokens in 4.40s. 
Token/sec: 58.37
Average acceptance length: 1.705

Generated 257 tokens in 3.02s. 
Token/sec: 85.09
Average acceptance length: 1.705

Generated 258 tokens in 2.66s. 
Token/sec: 97.04
Average acceptance length: 2.185

Generated 258 tokens in 2.66s. 
Token/sec: 97.09
Average acceptance length: 2.185

Generated 260 tokens in 2.60s. 
Token/sec: 99.97
Average acceptance length: 2.250

Generated 260 tokens in 2.60s. 
Token/sec: 99.96
Average acceptance length: 2.250

Generated 258 tokens in 2.63s. 
Token/sec: 98.26
Average acceptance length: 2.351

Generated 258 tokens in 2.62s. 
Token/sec: 98.31
Average acceptance length: 2.351

Generated 258 tokens in 2.71s. 
Token/sec: 95.08
Average acceptance length: 2.146

Generated 258 tokens in 2.72s. 
Token/sec: 95.01
Average acceptance length: 2.146

Generated 261 tokens in 2.59s. 
Token/sec: 100.74
Average acceptance length: 2.346

Generated 261 tokens in 2.74s. 
Token/sec: 95.24
Average acceptance length: 2.346

Generated 262 tokens in 4.24s. 
Token/sec: 61.76
Average acceptance length: 2.047

Generated 262 tokens in 2.84s. 
Token/sec: 92.21
Average acceptance length: 2.047

Generated 260 tokens in 2.76s. 
Token/sec: 94.16
Average acceptance length: 2.171

Generated 260 tokens in 2.73s. 
Token/sec: 95.41
Average acceptance length: 2.171

Generated 257 tokens in 2.79s. 
Token/sec: 92.24
Average acceptance length: 2.173

Generated 257 tokens in 2.63s. 
Token/sec: 97.88
Average acceptance length: 2.173

Generated 257 tokens in 2.65s. 
Token/sec: 96.96
Average acceptance length: 2.212

Generated 257 tokens in 2.65s. 
Token/sec: 96.81
Average acceptance length: 2.212

Generated 260 tokens in 2.76s. 
Token/sec: 94.05
Average acceptance length: 2.095

Generated 260 tokens in 2.76s. 
Token/sec: 94.16
Average acceptance length: 2.095

Generated 258 tokens in 2.93s. 
Token/sec: 88.04
Average acceptance length: 1.867

Generated 258 tokens in 2.93s. 
Token/sec: 88.03
Average acceptance length: 1.867

Generated 262 tokens in 4.26s. 
Token/sec: 61.56
Average acceptance length: 1.911

Generated 262 tokens in 2.90s. 
Token/sec: 90.45
Average acceptance length: 1.911

Generated 258 tokens in 2.89s. 
Token/sec: 89.25
Average acceptance length: 1.899

Generated 258 tokens in 2.89s. 
Token/sec: 89.23
Average acceptance length: 1.899

Generated 260 tokens in 2.78s. 
Token/sec: 93.38
Average acceptance length: 2.291

Generated 260 tokens in 2.66s. 
Token/sec: 97.63
Average acceptance length: 2.291

Generated 258 tokens in 2.48s. 
Token/sec: 103.9
Average acceptance length: 2.486

Generated 258 tokens in 2.49s. 
Token/sec: 103.61
Average acceptance length: 2.486
Warming up GPUs...
Warmup complete!
len=4096:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=4096:   5%|███▊                                                                        | 1/20 [00:11<03:44, 11.83s/it]len=4096:  10%|███████▌                                                                    | 2/20 [00:22<03:24, 11.38s/it]len=4096:  15%|███████████▍                                                                | 3/20 [00:33<03:09, 11.13s/it]len=4096:  20%|███████████████▏                                                            | 4/20 [00:45<03:01, 11.35s/it]len=4096:  25%|███████████████████                                                         | 5/20 [00:55<02:43, 10.92s/it]len=4096:  30%|██████████████████████▊                                                     | 6/20 [01:06<02:31, 10.81s/it]len=4096:  35%|██████████████████████████▌                                                 | 7/20 [01:16<02:17, 10.57s/it]len=4096:  40%|██████████████████████████████▍                                             | 8/20 [01:28<02:12, 11.05s/it]len=4096:  45%|██████████████████████████████████▏                                         | 9/20 [01:38<02:00, 10.92s/it]len=4096:  50%|█████████████████████████████████████▌                                     | 10/20 [01:48<01:46, 10.63s/it]len=4096:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:00<01:38, 10.99s/it]len=4096:  60%|█████████████████████████████████████████████                              | 12/20 [02:09<01:23, 10.46s/it]len=4096:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:20<01:13, 10.43s/it]len=4096:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:32<01:04, 10.83s/it]len=4096:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:41<00:52, 10.48s/it]len=4096:  80%|████████████████████████████████████████████████████████████               | 16/20 [02:51<00:41, 10.32s/it]len=4096:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [03:03<00:32, 10.73s/it]len=4096:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [03:14<00:21, 10.83s/it]len=4096:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:24<00:10, 10.55s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:36<00:00, 10.93s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:36<00:00, 10.81s/it]

Generated 257 tokens in 5.24s. 
Token/sec: 49.05
Average acceptance length: 0.760

Generated 257 tokens in 6.58s. 
Token/sec: 39.06
Average acceptance length: 0.760

Generated 258 tokens in 5.54s. 
Token/sec: 46.56
Average acceptance length: 0.755

Generated 258 tokens in 5.52s. 
Token/sec: 46.73
Average acceptance length: 0.755

Generated 257 tokens in 5.41s. 
Token/sec: 47.52
Average acceptance length: 0.760

Generated 257 tokens in 5.41s. 
Token/sec: 47.52
Average acceptance length: 0.760

Generated 257 tokens in 5.16s. 
Token/sec: 49.76
Average acceptance length: 0.849

Generated 257 tokens in 6.50s. 
Token/sec: 39.54
Average acceptance length: 0.849

Generated 258 tokens in 5.09s. 
Token/sec: 50.72
Average acceptance length: 0.856

Generated 258 tokens in 5.07s. 
Token/sec: 50.92
Average acceptance length: 0.856

Generated 258 tokens in 5.23s. 
Token/sec: 49.31
Average acceptance length: 0.830

Generated 258 tokens in 5.35s. 
Token/sec: 48.21
Average acceptance length: 0.830

Generated 258 tokens in 5.01s. 
Token/sec: 51.52
Average acceptance length: 0.883

Generated 258 tokens in 5.06s. 
Token/sec: 50.96
Average acceptance length: 0.883

Generated 259 tokens in 6.76s. 
Token/sec: 38.31
Average acceptance length: 0.774

Generated 259 tokens in 5.29s. 
Token/sec: 48.99
Average acceptance length: 0.774

Generated 258 tokens in 5.25s. 
Token/sec: 49.1
Average acceptance length: 0.856

Generated 258 tokens in 5.37s. 
Token/sec: 48.06
Average acceptance length: 0.856

Generated 258 tokens in 5.00s. 
Token/sec: 51.57
Average acceptance length: 0.940

Generated 258 tokens in 4.98s. 
Token/sec: 51.76
Average acceptance length: 0.940

Generated 258 tokens in 6.56s. 
Token/sec: 39.33
Average acceptance length: 0.817

Generated 258 tokens in 5.24s. 
Token/sec: 49.24
Average acceptance length: 0.817

Generated 259 tokens in 4.62s. 
Token/sec: 56.12
Average acceptance length: 1.123

Generated 259 tokens in 4.60s. 
Token/sec: 56.26
Average acceptance length: 1.123

Generated 257 tokens in 5.17s. 
Token/sec: 49.74
Average acceptance length: 0.823

Generated 257 tokens in 5.19s. 
Token/sec: 49.55
Average acceptance length: 0.823

Generated 258 tokens in 6.54s. 
Token/sec: 39.48
Average acceptance length: 0.843

Generated 258 tokens in 5.20s. 
Token/sec: 49.61
Average acceptance length: 0.843

Generated 258 tokens in 4.84s. 
Token/sec: 53.32
Average acceptance length: 0.969

Generated 258 tokens in 4.83s. 
Token/sec: 53.4
Average acceptance length: 0.969

Generated 259 tokens in 4.96s. 
Token/sec: 52.21
Average acceptance length: 0.977

Generated 259 tokens in 4.96s. 
Token/sec: 52.21
Average acceptance length: 0.977

Generated 257 tokens in 5.15s. 
Token/sec: 49.85
Average acceptance length: 0.836

Generated 257 tokens in 6.51s. 
Token/sec: 39.49
Average acceptance length: 0.836

Generated 257 tokens in 5.53s. 
Token/sec: 46.49
Average acceptance length: 0.658

Generated 257 tokens in 5.53s. 
Token/sec: 46.46
Average acceptance length: 0.658

Generated 258 tokens in 4.90s. 
Token/sec: 52.65
Average acceptance length: 0.985

Generated 258 tokens in 4.99s. 
Token/sec: 51.65
Average acceptance length: 0.985

Generated 258 tokens in 5.25s. 
Token/sec: 49.13
Average acceptance length: 0.792

Generated 258 tokens in 6.56s. 
Token/sec: 39.33
Average acceptance length: 0.792
Warming up GPUs...
Warmup complete!
len=8192:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=8192:   5%|███▊                                                                        | 1/20 [00:16<05:11, 16.37s/it]len=8192:  10%|███████▌                                                                    | 2/20 [00:34<05:10, 17.26s/it]len=8192:  15%|███████████▍                                                                | 3/20 [00:49<04:37, 16.33s/it]len=8192:  20%|███████████████▏                                                            | 4/20 [01:06<04:25, 16.61s/it]len=8192:  25%|███████████████████                                                         | 5/20 [01:22<04:03, 16.22s/it]len=8192:  30%|██████████████████████▊                                                     | 6/20 [01:39<03:52, 16.59s/it]len=8192:  35%|██████████████████████████▌                                                 | 7/20 [01:55<03:34, 16.50s/it]len=8192:  40%|██████████████████████████████▍                                             | 8/20 [02:13<03:22, 16.88s/it]len=8192:  45%|██████████████████████████████████▏                                         | 9/20 [02:29<03:04, 16.73s/it]len=8192:  50%|█████████████████████████████████████▌                                     | 10/20 [02:48<02:52, 17.21s/it]len=8192:  55%|█████████████████████████████████████████▎                                 | 11/20 [03:03<02:30, 16.72s/it]len=8192:  60%|█████████████████████████████████████████████                              | 12/20 [03:22<02:18, 17.26s/it]len=8192:  65%|████████████████████████████████████████████████▊                          | 13/20 [03:37<01:57, 16.76s/it]len=8192:  70%|████████████████████████████████████████████████████▌                      | 14/20 [03:55<01:42, 17.11s/it]len=8192:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [04:11<01:23, 16.70s/it]len=8192:  80%|████████████████████████████████████████████████████████████               | 16/20 [04:28<01:07, 16.84s/it]len=8192:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [04:45<00:50, 16.87s/it]len=8192:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [05:02<00:33, 16.88s/it]len=8192:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [05:18<00:16, 16.64s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:36<00:00, 16.93s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:36<00:00, 16.81s/it]

Generated 258 tokens in 8.16s. 
Token/sec: 31.63
Average acceptance length: 0.573

Generated 258 tokens in 8.19s. 
Token/sec: 31.48
Average acceptance length: 0.573

Generated 258 tokens in 8.23s. 
Token/sec: 31.34
Average acceptance length: 0.554

Generated 258 tokens in 9.63s. 
Token/sec: 26.8
Average acceptance length: 0.554

Generated 257 tokens in 7.62s. 
Token/sec: 33.73
Average acceptance length: 0.658

Generated 257 tokens in 7.59s. 
Token/sec: 33.86
Average acceptance length: 0.658

Generated 257 tokens in 7.84s. 
Token/sec: 32.8
Average acceptance length: 0.647

Generated 257 tokens in 9.17s. 
Token/sec: 28.02
Average acceptance length: 0.647

Generated 258 tokens in 7.77s. 
Token/sec: 33.22
Average acceptance length: 0.613

Generated 258 tokens in 7.76s. 
Token/sec: 33.23
Average acceptance length: 0.613

Generated 257 tokens in 7.89s. 
Token/sec: 32.56
Average acceptance length: 0.658

Generated 257 tokens in 9.38s. 
Token/sec: 27.4
Average acceptance length: 0.658

Generated 258 tokens in 8.17s. 
Token/sec: 31.58
Average acceptance length: 0.593

Generated 258 tokens in 8.14s. 
Token/sec: 31.7
Average acceptance length: 0.593

Generated 258 tokens in 8.16s. 
Token/sec: 31.61
Average acceptance length: 0.545

Generated 258 tokens in 9.51s. 
Token/sec: 27.13
Average acceptance length: 0.545

Generated 258 tokens in 8.27s. 
Token/sec: 31.19
Average acceptance length: 0.583

Generated 258 tokens in 8.10s. 
Token/sec: 31.86
Average acceptance length: 0.583

Generated 257 tokens in 8.39s. 
Token/sec: 30.63
Average acceptance length: 0.567

Generated 257 tokens in 9.87s. 
Token/sec: 26.04
Average acceptance length: 0.567

Generated 258 tokens in 7.77s. 
Token/sec: 33.2
Average acceptance length: 0.665

Generated 258 tokens in 7.82s. 
Token/sec: 32.99
Average acceptance length: 0.665

Generated 258 tokens in 8.58s. 
Token/sec: 30.05
Average acceptance length: 0.527

Generated 258 tokens in 9.90s. 
Token/sec: 26.05
Average acceptance length: 0.527

Generated 257 tokens in 7.79s. 
Token/sec: 32.99
Average acceptance length: 0.680

Generated 257 tokens in 7.79s. 
Token/sec: 32.99
Average acceptance length: 0.680

Generated 258 tokens in 8.29s. 
Token/sec: 31.11
Average acceptance length: 0.593

Generated 258 tokens in 9.61s. 
Token/sec: 26.85
Average acceptance length: 0.593

Generated 257 tokens in 7.86s. 
Token/sec: 32.69
Average acceptance length: 0.658

Generated 257 tokens in 7.87s. 
Token/sec: 32.66
Average acceptance length: 0.658

Generated 257 tokens in 7.91s. 
Token/sec: 32.47
Average acceptance length: 0.616

Generated 257 tokens in 9.25s. 
Token/sec: 27.79
Average acceptance length: 0.616

Generated 257 tokens in 8.46s. 
Token/sec: 30.39
Average acceptance length: 0.521

Generated 257 tokens in 8.46s. 
Token/sec: 30.39
Average acceptance length: 0.521

Generated 258 tokens in 7.77s. 
Token/sec: 33.22
Average acceptance length: 0.654

Generated 258 tokens in 9.12s. 
Token/sec: 28.28
Average acceptance length: 0.654

Generated 257 tokens in 7.99s. 
Token/sec: 32.17
Average acceptance length: 0.596

Generated 257 tokens in 8.08s. 
Token/sec: 31.8
Average acceptance length: 0.596

Generated 257 tokens in 8.10s. 
Token/sec: 31.71
Average acceptance length: 0.637

Generated 257 tokens in 9.46s. 
Token/sec: 27.17
Average acceptance length: 0.637
Warming up GPUs...
Warmup complete!
len=16384:   0%|                                                                                   | 0/20 [00:00<?, ?it/s]len=16384:   5%|███▊                                                                       | 1/20 [00:28<08:58, 28.35s/it]len=16384:  10%|███████▌                                                                   | 2/20 [00:55<08:20, 27.78s/it]len=16384:  15%|███████████▎                                                               | 3/20 [01:23<07:48, 27.58s/it]len=16384:  20%|███████████████                                                            | 4/20 [01:49<07:16, 27.29s/it]len=16384:  25%|██████████████████▊                                                        | 5/20 [02:17<06:50, 27.35s/it]len=16384:  30%|██████████████████████▌                                                    | 6/20 [02:43<06:17, 26.99s/it]len=16384:  35%|██████████████████████████▎                                                | 7/20 [03:12<05:59, 27.69s/it]len=16384:  40%|██████████████████████████████                                             | 8/20 [03:39<05:27, 27.29s/it]len=16384:  45%|█████████████████████████████████▊                                         | 9/20 [04:06<05:00, 27.34s/it]len=16384:  50%|█████████████████████████████████████                                     | 10/20 [04:34<04:34, 27.47s/it]len=16384:  55%|████████████████████████████████████████▋                                 | 11/20 [05:00<04:02, 26.96s/it]len=16384:  60%|████████████████████████████████████████████▍                             | 12/20 [05:28<03:39, 27.39s/it]len=16384:  65%|████████████████████████████████████████████████                          | 13/20 [05:57<03:14, 27.78s/it]len=16384:  70%|███████████████████████████████████████████████████▊                      | 14/20 [06:26<02:48, 28.12s/it]len=16384:  75%|███████████████████████████████████████████████████████▌                  | 15/20 [06:54<02:21, 28.22s/it]len=16384:  80%|███████████████████████████████████████████████████████████▏              | 16/20 [07:21<01:51, 27.83s/it]len=16384:  85%|██████████████████████████████████████████████████████████████▉           | 17/20 [07:47<01:21, 27.17s/it]len=16384:  90%|██████████████████████████████████████████████████████████████████▌       | 18/20 [08:14<00:54, 27.29s/it]len=16384:  95%|██████████████████████████████████████████████████████████████████████▎   | 19/20 [08:42<00:27, 27.27s/it]len=16384: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [09:11<00:00, 27.92s/it]len=16384: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [09:11<00:00, 27.57s/it]

Generated 258 tokens in 13.46s. 
Token/sec: 19.16
Average acceptance length: 0.458

Generated 258 tokens in 14.85s. 
Token/sec: 17.37
Average acceptance length: 0.458

Generated 257 tokens in 12.99s. 
Token/sec: 19.78
Average acceptance length: 0.494

Generated 257 tokens in 14.36s. 
Token/sec: 17.9
Average acceptance length: 0.494

Generated 257 tokens in 13.63s. 
Token/sec: 18.86
Average acceptance length: 0.404

Generated 257 tokens in 13.68s. 
Token/sec: 18.79
Average acceptance length: 0.404

Generated 258 tokens in 14.09s. 
Token/sec: 18.32
Average acceptance length: 0.583

Generated 258 tokens in 12.71s. 
Token/sec: 20.29
Average acceptance length: 0.583

Generated 257 tokens in 12.71s. 
Token/sec: 20.22
Average acceptance length: 0.512

Generated 257 tokens in 14.71s. 
Token/sec: 17.47
Average acceptance length: 0.512

Generated 258 tokens in 13.14s. 
Token/sec: 19.64
Average acceptance length: 0.545

Generated 258 tokens in 13.13s. 
Token/sec: 19.65
Average acceptance length: 0.545

Generated 257 tokens in 15.21s. 
Token/sec: 16.9
Average acceptance length: 0.444

Generated 257 tokens in 13.87s. 
Token/sec: 18.53
Average acceptance length: 0.444

Generated 258 tokens in 13.85s. 
Token/sec: 18.62
Average acceptance length: 0.602

Generated 258 tokens in 12.54s. 
Token/sec: 20.57
Average acceptance length: 0.602

Generated 257 tokens in 13.07s. 
Token/sec: 19.66
Average acceptance length: 0.521

Generated 257 tokens in 14.35s. 
Token/sec: 17.91
Average acceptance length: 0.521

Generated 257 tokens in 13.19s. 
Token/sec: 19.48
Average acceptance length: 0.452

Generated 257 tokens in 14.54s. 
Token/sec: 17.67
Average acceptance length: 0.452

Generated 257 tokens in 12.88s. 
Token/sec: 19.95
Average acceptance length: 0.460

Generated 257 tokens in 12.89s. 
Token/sec: 19.93
Average acceptance length: 0.460

Generated 257 tokens in 14.83s. 
Token/sec: 17.33
Average acceptance length: 0.494

Generated 257 tokens in 13.49s. 
Token/sec: 19.05
Average acceptance length: 0.494

Generated 257 tokens in 15.00s. 
Token/sec: 17.14
Average acceptance length: 0.428

Generated 257 tokens in 13.66s. 
Token/sec: 18.82
Average acceptance length: 0.428

Generated 257 tokens in 15.10s. 
Token/sec: 17.02
Average acceptance length: 0.436

Generated 257 tokens in 13.77s. 
Token/sec: 18.67
Average acceptance length: 0.436

Generated 257 tokens in 13.54s. 
Token/sec: 18.99
Average acceptance length: 0.444

Generated 257 tokens in 14.89s. 
Token/sec: 17.26
Average acceptance length: 0.444

Generated 257 tokens in 12.80s. 
Token/sec: 20.08
Average acceptance length: 0.577

Generated 257 tokens in 14.08s. 
Token/sec: 18.25
Average acceptance length: 0.577

Generated 257 tokens in 12.79s. 
Token/sec: 20.09
Average acceptance length: 0.494

Generated 257 tokens in 12.80s. 
Token/sec: 20.09
Average acceptance length: 0.494

Generated 258 tokens in 14.44s. 
Token/sec: 17.87
Average acceptance length: 0.545

Generated 258 tokens in 13.09s. 
Token/sec: 19.7
Average acceptance length: 0.545

Generated 258 tokens in 14.26s. 
Token/sec: 18.09
Average acceptance length: 0.593

Generated 258 tokens in 12.95s. 
Token/sec: 19.93
Average acceptance length: 0.593

Generated 257 tokens in 14.01s. 
Token/sec: 18.35
Average acceptance length: 0.412

Generated 257 tokens in 15.37s. 
Token/sec: 16.72
Average acceptance length: 0.412
Experiment complete!
Loading checkpoint shards:   0%|                                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|███████████████                                             | 1/4 [00:00<00:02,  1.37it/s]Loading checkpoint shards:  50%|██████████████████████████████                              | 2/4 [00:01<00:01,  1.39it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████               | 3/4 [00:02<00:00,  1.41it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.96it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.71it/s]
/home/hjkim/workspace/SpecExtend_Reb/eagle_3/model_eagle.py:109: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ea_layer_state_dict = torch.load(load_model_path,
Warming up GPUs...
Warmup complete!
len=1024:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=1024:   5%|███▊                                                                        | 1/20 [00:05<01:52,  5.94s/it]len=1024:  10%|███████▌                                                                    | 2/20 [00:12<01:58,  6.57s/it]len=1024:  15%|███████████▍                                                                | 3/20 [00:18<01:45,  6.19s/it]len=1024:  20%|███████████████▏                                                            | 4/20 [00:24<01:35,  5.99s/it]len=1024:  25%|███████████████████                                                         | 5/20 [00:30<01:30,  6.05s/it]len=1024:  30%|██████████████████████▊                                                     | 6/20 [00:36<01:22,  5.88s/it]len=1024:  35%|██████████████████████████▌                                                 | 7/20 [00:42<01:20,  6.21s/it]len=1024:  40%|██████████████████████████████▍                                             | 8/20 [00:49<01:13,  6.16s/it]len=1024:  45%|██████████████████████████████████▏                                         | 9/20 [00:55<01:07,  6.10s/it]len=1024:  50%|█████████████████████████████████████▌                                     | 10/20 [01:00<01:00,  6.02s/it]len=1024:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:06<00:52,  5.85s/it]len=1024:  60%|█████████████████████████████████████████████                              | 12/20 [01:12<00:46,  5.86s/it]len=1024:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:19<00:43,  6.27s/it]len=1024:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:25<00:37,  6.27s/it]len=1024:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:32<00:32,  6.41s/it]len=1024:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:38<00:25,  6.40s/it]len=1024:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:44<00:18,  6.13s/it]len=1024:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [01:51<00:12,  6.37s/it]len=1024:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [01:56<00:06,  6.11s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:02<00:00,  5.94s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:02<00:00,  6.11s/it]

Generated 258 tokens in 2.97s. 
Token/sec: 86.81
Average acceptance length: 1.457

Generated 258 tokens in 2.97s. 
Token/sec: 86.91
Average acceptance length: 1.457

Generated 257 tokens in 4.17s. 
Token/sec: 61.6
Average acceptance length: 1.495

Generated 257 tokens in 2.83s. 
Token/sec: 90.66
Average acceptance length: 1.495

Generated 257 tokens in 2.87s. 
Token/sec: 89.62
Average acceptance length: 1.520

Generated 257 tokens in 2.87s. 
Token/sec: 89.63
Average acceptance length: 1.520

Generated 258 tokens in 2.86s. 
Token/sec: 90.18
Average acceptance length: 1.688

Generated 258 tokens in 2.82s. 
Token/sec: 91.48
Average acceptance length: 1.688

Generated 257 tokens in 3.08s. 
Token/sec: 83.5
Average acceptance length: 1.274

Generated 257 tokens in 3.08s. 
Token/sec: 83.54
Average acceptance length: 1.274

Generated 257 tokens in 2.78s. 
Token/sec: 92.38
Average acceptance length: 1.570

Generated 257 tokens in 2.78s. 
Token/sec: 92.53
Average acceptance length: 1.570

Generated 258 tokens in 2.76s. 
Token/sec: 93.53
Average acceptance length: 1.660

Generated 258 tokens in 4.11s. 
Token/sec: 62.7
Average acceptance length: 1.660

Generated 257 tokens in 3.03s. 
Token/sec: 84.79
Average acceptance length: 1.358

Generated 257 tokens in 3.03s. 
Token/sec: 84.76
Average acceptance length: 1.358

Generated 258 tokens in 2.97s. 
Token/sec: 86.9
Average acceptance length: 1.411

Generated 258 tokens in 2.99s. 
Token/sec: 86.16
Average acceptance length: 1.411

Generated 260 tokens in 2.95s. 
Token/sec: 88.27
Average acceptance length: 1.549

Generated 260 tokens in 2.89s. 
Token/sec: 89.92
Average acceptance length: 1.549

Generated 258 tokens in 2.74s. 
Token/sec: 94.19
Average acceptance length: 1.660

Generated 258 tokens in 2.73s. 
Token/sec: 94.36
Average acceptance length: 1.660

Generated 259 tokens in 2.94s. 
Token/sec: 88.14
Average acceptance length: 1.443

Generated 259 tokens in 2.94s. 
Token/sec: 88.07
Average acceptance length: 1.443

Generated 260 tokens in 4.28s. 
Token/sec: 60.79
Average acceptance length: 1.476

Generated 260 tokens in 2.94s. 
Token/sec: 88.48
Average acceptance length: 1.476

Generated 257 tokens in 3.00s. 
Token/sec: 85.66
Average acceptance length: 1.358

Generated 257 tokens in 3.27s. 
Token/sec: 78.61
Average acceptance length: 1.358

Generated 258 tokens in 3.45s. 
Token/sec: 74.7
Average acceptance length: 1.243

Generated 258 tokens in 3.26s. 
Token/sec: 79.23
Average acceptance length: 1.243

Generated 257 tokens in 3.19s. 
Token/sec: 80.65
Average acceptance length: 1.235

Generated 257 tokens in 3.20s. 
Token/sec: 80.38
Average acceptance length: 1.235

Generated 259 tokens in 2.75s. 
Token/sec: 94.2
Average acceptance length: 1.643

Generated 259 tokens in 2.75s. 
Token/sec: 94.23
Average acceptance length: 1.643

Generated 261 tokens in 4.14s. 
Token/sec: 63.09
Average acceptance length: 1.610

Generated 261 tokens in 2.79s. 
Token/sec: 93.51
Average acceptance length: 1.610

Generated 257 tokens in 2.74s. 
Token/sec: 93.64
Average acceptance length: 1.622

Generated 257 tokens in 2.75s. 
Token/sec: 93.62
Average acceptance length: 1.622

Generated 257 tokens in 2.77s. 
Token/sec: 92.89
Average acceptance length: 1.596

Generated 257 tokens in 2.77s. 
Token/sec: 92.82
Average acceptance length: 1.596
Warming up GPUs...
Warmup complete!
len=2048:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=2048:   5%|███▊                                                                        | 1/20 [00:06<01:58,  6.22s/it]len=2048:  10%|███████▌                                                                    | 2/20 [00:12<01:55,  6.39s/it]len=2048:  15%|███████████▍                                                                | 3/20 [00:20<02:00,  7.12s/it]len=2048:  20%|███████████████▏                                                            | 4/20 [00:27<01:48,  6.81s/it]len=2048:  25%|███████████████████                                                         | 5/20 [00:33<01:37,  6.51s/it]len=2048:  30%|██████████████████████▊                                                     | 6/20 [00:39<01:30,  6.44s/it]len=2048:  35%|██████████████████████████▌                                                 | 7/20 [00:45<01:21,  6.29s/it]len=2048:  40%|██████████████████████████████▍                                             | 8/20 [00:51<01:13,  6.12s/it]len=2048:  45%|██████████████████████████████████▏                                         | 9/20 [00:58<01:12,  6.58s/it]len=2048:  50%|█████████████████████████████████████▌                                     | 10/20 [01:04<01:04,  6.49s/it]len=2048:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:11<00:58,  6.47s/it]len=2048:  60%|█████████████████████████████████████████████                              | 12/20 [01:17<00:51,  6.46s/it]len=2048:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:24<00:44,  6.41s/it]len=2048:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:32<00:41,  6.98s/it]len=2048:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:38<00:33,  6.69s/it]len=2048:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:45<00:26,  6.70s/it]len=2048:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:51<00:19,  6.65s/it]len=2048:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [01:57<00:12,  6.43s/it]len=2048:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [02:05<00:06,  6.76s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:11<00:00,  6.54s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:11<00:00,  6.56s/it]

Generated 259 tokens in 3.12s. 
Token/sec: 82.97
Average acceptance length: 1.698

Generated 257 tokens in 3.09s. 
Token/sec: 83.07
Average acceptance length: 1.705

Generated 258 tokens in 3.25s. 
Token/sec: 79.29
Average acceptance length: 1.529

Generated 258 tokens in 3.25s. 
Token/sec: 79.35
Average acceptance length: 1.529

Generated 257 tokens in 3.32s. 
Token/sec: 77.52
Average acceptance length: 1.471

Generated 257 tokens in 4.66s. 
Token/sec: 55.14
Average acceptance length: 1.471

Generated 258 tokens in 3.17s. 
Token/sec: 81.49
Average acceptance length: 1.606

Generated 258 tokens in 3.16s. 
Token/sec: 81.53
Average acceptance length: 1.606

Generated 257 tokens in 2.99s. 
Token/sec: 85.99
Average acceptance length: 1.793

Generated 257 tokens in 2.99s. 
Token/sec: 86.07
Average acceptance length: 1.793

Generated 257 tokens in 3.15s. 
Token/sec: 81.55
Average acceptance length: 1.545

Generated 257 tokens in 3.15s. 
Token/sec: 81.62
Average acceptance length: 1.545

Generated 259 tokens in 2.99s. 
Token/sec: 86.69
Average acceptance length: 1.755

Generated 259 tokens in 2.99s. 
Token/sec: 86.62
Average acceptance length: 1.755

Generated 257 tokens in 2.88s. 
Token/sec: 89.17
Average acceptance length: 1.920

Generated 257 tokens in 2.88s. 
Token/sec: 89.2
Average acceptance length: 1.920

Generated 258 tokens in 4.47s. 
Token/sec: 57.71
Average acceptance length: 1.660

Generated 258 tokens in 3.12s. 
Token/sec: 82.64
Average acceptance length: 1.660

Generated 259 tokens in 3.13s. 
Token/sec: 82.75
Average acceptance length: 1.670

Generated 259 tokens in 3.15s. 
Token/sec: 82.15
Average acceptance length: 1.670

Generated 259 tokens in 3.21s. 
Token/sec: 80.64
Average acceptance length: 1.616

Generated 259 tokens in 3.21s. 
Token/sec: 80.62
Average acceptance length: 1.616

Generated 259 tokens in 3.20s. 
Token/sec: 80.84
Average acceptance length: 1.616

Generated 259 tokens in 3.20s. 
Token/sec: 80.83
Average acceptance length: 1.616

Generated 259 tokens in 3.15s. 
Token/sec: 82.24
Average acceptance length: 1.616

Generated 259 tokens in 3.15s. 
Token/sec: 82.19
Average acceptance length: 1.616

Generated 258 tokens in 4.73s. 
Token/sec: 54.53
Average acceptance length: 1.411

Generated 258 tokens in 3.57s. 
Token/sec: 72.25
Average acceptance length: 1.411

Generated 258 tokens in 3.01s. 
Token/sec: 85.62
Average acceptance length: 1.688

Generated 258 tokens in 3.01s. 
Token/sec: 85.82
Average acceptance length: 1.688

Generated 259 tokens in 3.36s. 
Token/sec: 77.1
Average acceptance length: 1.467

Generated 259 tokens in 3.35s. 
Token/sec: 77.34
Average acceptance length: 1.467

Generated 259 tokens in 3.27s. 
Token/sec: 79.27
Average acceptance length: 1.539

Generated 259 tokens in 3.27s. 
Token/sec: 79.31
Average acceptance length: 1.539

Generated 257 tokens in 2.95s. 
Token/sec: 87.12
Average acceptance length: 1.763

Generated 257 tokens in 2.95s. 
Token/sec: 87.07
Average acceptance length: 1.763

Generated 258 tokens in 4.43s. 
Token/sec: 58.18
Average acceptance length: 1.660

Generated 258 tokens in 3.11s. 
Token/sec: 83.07
Average acceptance length: 1.660

Generated 259 tokens in 3.01s. 
Token/sec: 86.05
Average acceptance length: 1.698

Generated 259 tokens in 3.01s. 
Token/sec: 86.06
Average acceptance length: 1.698
Warming up GPUs...
Warmup complete!
len=4096:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=4096:   5%|███▊                                                                        | 1/20 [00:10<03:15, 10.29s/it]len=4096:  10%|███████▌                                                                    | 2/20 [00:22<03:28, 11.57s/it]len=4096:  15%|███████████▍                                                                | 3/20 [00:34<03:14, 11.47s/it]len=4096:  20%|███████████████▏                                                            | 4/20 [00:44<02:58, 11.16s/it]len=4096:  25%|███████████████████                                                         | 5/20 [00:57<02:55, 11.69s/it]len=4096:  30%|██████████████████████▊                                                     | 6/20 [01:08<02:40, 11.50s/it]len=4096:  35%|██████████████████████████▌                                                 | 7/20 [01:19<02:25, 11.19s/it]len=4096:  40%|██████████████████████████████▍                                             | 8/20 [01:31<02:18, 11.53s/it]len=4096:  45%|██████████████████████████████████▏                                         | 9/20 [01:41<02:03, 11.24s/it]len=4096:  50%|█████████████████████████████████████▌                                     | 10/20 [01:53<01:52, 11.28s/it]len=4096:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:06<01:45, 11.72s/it]len=4096:  60%|█████████████████████████████████████████████                              | 12/20 [02:16<01:31, 11.49s/it]len=4096:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:27<01:19, 11.33s/it]len=4096:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:40<01:09, 11.57s/it]len=4096:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:51<00:57, 11.50s/it]len=4096:  80%|████████████████████████████████████████████████████████████               | 16/20 [03:02<00:45, 11.36s/it]len=4096:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [03:14<00:34, 11.63s/it]len=4096:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [03:26<00:23, 11.70s/it]len=4096:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:37<00:11, 11.41s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:50<00:00, 11.82s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:50<00:00, 11.51s/it]

Generated 258 tokens in 5.14s. 
Token/sec: 50.17
Average acceptance length: 0.870

Generated 258 tokens in 5.14s. 
Token/sec: 50.21
Average acceptance length: 0.870

Generated 258 tokens in 5.55s. 
Token/sec: 46.5
Average acceptance length: 0.697

Generated 258 tokens in 6.90s. 
Token/sec: 37.38
Average acceptance length: 0.697

Generated 257 tokens in 5.68s. 
Token/sec: 45.29
Average acceptance length: 0.691

Generated 257 tokens in 5.67s. 
Token/sec: 45.34
Average acceptance length: 0.691

Generated 257 tokens in 5.34s. 
Token/sec: 48.14
Average acceptance length: 0.797

Generated 257 tokens in 5.34s. 
Token/sec: 48.16
Average acceptance length: 0.797

Generated 258 tokens in 5.64s. 
Token/sec: 45.73
Average acceptance length: 0.686

Generated 258 tokens in 6.98s. 
Token/sec: 36.98
Average acceptance length: 0.686

Generated 257 tokens in 5.58s. 
Token/sec: 46.09
Average acceptance length: 0.725

Generated 257 tokens in 5.53s. 
Token/sec: 46.44
Average acceptance length: 0.725

Generated 259 tokens in 5.28s. 
Token/sec: 49.04
Average acceptance length: 0.799

Generated 259 tokens in 5.28s. 
Token/sec: 49.06
Average acceptance length: 0.799

Generated 258 tokens in 5.45s. 
Token/sec: 47.34
Average acceptance length: 0.767

Generated 258 tokens in 6.78s. 
Token/sec: 38.03
Average acceptance length: 0.767

Generated 258 tokens in 5.31s. 
Token/sec: 48.62
Average acceptance length: 0.817

Generated 258 tokens in 5.31s. 
Token/sec: 48.63
Average acceptance length: 0.817

Generated 258 tokens in 5.67s. 
Token/sec: 45.48
Average acceptance length: 0.686

Generated 258 tokens in 5.67s. 
Token/sec: 45.49
Average acceptance length: 0.686

Generated 258 tokens in 5.68s. 
Token/sec: 45.39
Average acceptance length: 0.686

Generated 258 tokens in 7.04s. 
Token/sec: 36.64
Average acceptance length: 0.686

Generated 257 tokens in 5.46s. 
Token/sec: 47.05
Average acceptance length: 0.748

Generated 257 tokens in 5.47s. 
Token/sec: 46.98
Average acceptance length: 0.748

Generated 257 tokens in 5.54s. 
Token/sec: 46.37
Average acceptance length: 0.772

Generated 257 tokens in 5.41s. 
Token/sec: 47.46
Average acceptance length: 0.772

Generated 257 tokens in 5.39s. 
Token/sec: 47.71
Average acceptance length: 0.748

Generated 257 tokens in 6.73s. 
Token/sec: 38.21
Average acceptance length: 0.748

Generated 257 tokens in 5.67s. 
Token/sec: 45.31
Average acceptance length: 0.669

Generated 257 tokens in 5.67s. 
Token/sec: 45.34
Average acceptance length: 0.669

Generated 257 tokens in 5.45s. 
Token/sec: 47.12
Average acceptance length: 0.725

Generated 257 tokens in 5.55s. 
Token/sec: 46.27
Average acceptance length: 0.725

Generated 257 tokens in 6.84s. 
Token/sec: 37.56
Average acceptance length: 0.748

Generated 257 tokens in 5.42s. 
Token/sec: 47.38
Average acceptance length: 0.748

Generated 257 tokens in 5.93s. 
Token/sec: 43.35
Average acceptance length: 0.596

Generated 257 tokens in 5.93s. 
Token/sec: 43.34
Average acceptance length: 0.596

Generated 258 tokens in 5.31s. 
Token/sec: 48.55
Average acceptance length: 0.817

Generated 258 tokens in 5.40s. 
Token/sec: 47.78
Average acceptance length: 0.817

Generated 257 tokens in 7.05s. 
Token/sec: 36.47
Average acceptance length: 0.680

Generated 257 tokens in 5.73s. 
Token/sec: 44.88
Average acceptance length: 0.680
Warming up GPUs...
Warmup complete!
len=8192:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=8192:   5%|███▊                                                                        | 1/20 [00:18<05:47, 18.31s/it]len=8192:  10%|███████▌                                                                    | 2/20 [00:36<05:23, 17.96s/it]len=8192:  15%|███████████▍                                                                | 3/20 [00:51<04:47, 16.89s/it]len=8192:  20%|███████████████▏                                                            | 4/20 [01:10<04:40, 17.55s/it]len=8192:  25%|███████████████████                                                         | 5/20 [01:26<04:17, 17.17s/it]len=8192:  30%|██████████████████████▊                                                     | 6/20 [01:45<04:08, 17.76s/it]len=8192:  35%|██████████████████████████▌                                                 | 7/20 [02:04<03:55, 18.10s/it]len=8192:  40%|██████████████████████████████▍                                             | 8/20 [02:21<03:33, 17.81s/it]len=8192:  45%|██████████████████████████████████▏                                         | 9/20 [02:40<03:18, 18.03s/it]len=8192:  50%|█████████████████████████████████████▌                                     | 10/20 [02:57<02:58, 17.83s/it]len=8192:  55%|█████████████████████████████████████████▎                                 | 11/20 [03:15<02:41, 17.89s/it]len=8192:  60%|█████████████████████████████████████████████                              | 12/20 [03:31<02:19, 17.42s/it]len=8192:  65%|████████████████████████████████████████████████▊                          | 13/20 [03:51<02:06, 18.09s/it]len=8192:  70%|████████████████████████████████████████████████████▌                      | 14/20 [04:08<01:46, 17.80s/it]len=8192:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [04:28<01:31, 18.29s/it]len=8192:  80%|████████████████████████████████████████████████████████████               | 16/20 [04:45<01:11, 17.95s/it]len=8192:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [05:03<00:53, 17.95s/it]len=8192:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [05:20<00:35, 17.91s/it]len=8192:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [05:39<00:18, 18.07s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:55<00:00, 17.60s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:55<00:00, 17.80s/it]

Generated 257 tokens in 9.13s. 
Token/sec: 28.14
Average acceptance length: 0.460

Generated 257 tokens in 9.16s. 
Token/sec: 28.06
Average acceptance length: 0.460

Generated 257 tokens in 9.52s. 
Token/sec: 26.99
Average acceptance length: 0.647

Generated 257 tokens in 8.17s. 
Token/sec: 31.45
Average acceptance length: 0.647

Generated 257 tokens in 7.79s. 
Token/sec: 32.99
Average acceptance length: 0.577

Generated 257 tokens in 7.81s. 
Token/sec: 32.92
Average acceptance length: 0.577

Generated 258 tokens in 9.95s. 
Token/sec: 25.93
Average acceptance length: 0.466

Generated 258 tokens in 8.61s. 
Token/sec: 29.97
Average acceptance length: 0.466

Generated 257 tokens in 8.24s. 
Token/sec: 31.19
Average acceptance length: 0.627

Generated 257 tokens in 8.24s. 
Token/sec: 31.21
Average acceptance length: 0.627

Generated 257 tokens in 10.13s. 
Token/sec: 25.38
Average acceptance length: 0.494

Generated 257 tokens in 8.77s. 
Token/sec: 29.3
Average acceptance length: 0.494

Generated 257 tokens in 8.72s. 
Token/sec: 29.47
Average acceptance length: 0.460

Generated 257 tokens in 10.05s. 
Token/sec: 25.58
Average acceptance length: 0.460

Generated 258 tokens in 8.57s. 
Token/sec: 30.09
Average acceptance length: 0.518

Generated 258 tokens in 8.59s. 
Token/sec: 30.04
Average acceptance length: 0.518

Generated 257 tokens in 8.58s. 
Token/sec: 29.97
Average acceptance length: 0.486

Generated 257 tokens in 9.95s. 
Token/sec: 25.84
Average acceptance length: 0.486

Generated 258 tokens in 8.68s. 
Token/sec: 29.74
Average acceptance length: 0.527

Generated 258 tokens in 8.68s. 
Token/sec: 29.72
Average acceptance length: 0.527

Generated 257 tokens in 8.32s. 
Token/sec: 30.88
Average acceptance length: 0.486

Generated 257 tokens in 9.70s. 
Token/sec: 26.5
Average acceptance length: 0.486

Generated 258 tokens in 8.16s. 
Token/sec: 31.62
Average acceptance length: 0.545

Generated 258 tokens in 8.15s. 
Token/sec: 31.66
Average acceptance length: 0.545

Generated 257 tokens in 9.14s. 
Token/sec: 28.11
Average acceptance length: 0.444

Generated 257 tokens in 10.47s. 
Token/sec: 24.54
Average acceptance length: 0.444

Generated 257 tokens in 8.56s. 
Token/sec: 30.04
Average acceptance length: 0.586

Generated 257 tokens in 8.55s. 
Token/sec: 30.05
Average acceptance length: 0.586

Generated 257 tokens in 10.40s. 
Token/sec: 24.71
Average acceptance length: 0.512

Generated 257 tokens in 9.02s. 
Token/sec: 28.5
Average acceptance length: 0.512

Generated 257 tokens in 8.56s. 
Token/sec: 30.01
Average acceptance length: 0.548

Generated 257 tokens in 8.57s. 
Token/sec: 29.98
Average acceptance length: 0.548

Generated 258 tokens in 9.64s. 
Token/sec: 26.76
Average acceptance length: 0.602

Generated 258 tokens in 8.30s. 
Token/sec: 31.08
Average acceptance length: 0.602

Generated 258 tokens in 8.89s. 
Token/sec: 29.01
Average acceptance length: 0.518

Generated 258 tokens in 8.89s. 
Token/sec: 29.02
Average acceptance length: 0.518

Generated 257 tokens in 9.87s. 
Token/sec: 26.04
Average acceptance length: 0.521

Generated 257 tokens in 8.54s. 
Token/sec: 30.08
Average acceptance length: 0.521

Generated 257 tokens in 8.24s. 
Token/sec: 31.19
Average acceptance length: 0.627

Generated 257 tokens in 8.25s. 
Token/sec: 31.16
Average acceptance length: 0.627
Warming up GPUs...
Warmup complete!
len=16000:   0%|                                                                                   | 0/20 [00:00<?, ?it/s]len=16000:   5%|███▊                                                                       | 1/20 [00:26<08:21, 26.41s/it]len=16000:  10%|███████▌                                                                   | 2/20 [00:51<07:46, 25.90s/it]len=16000:  15%|███████████▎                                                               | 3/20 [01:18<07:24, 26.15s/it]len=16000:  20%|███████████████                                                            | 4/20 [01:44<06:56, 26.03s/it]len=16000:  25%|██████████████████▊                                                        | 5/20 [02:10<06:33, 26.22s/it]len=16000:  30%|██████████████████████▌                                                    | 6/20 [02:37<06:09, 26.41s/it]len=16000:  35%|██████████████████████████▎                                                | 7/20 [03:07<05:56, 27.45s/it]len=16000:  40%|██████████████████████████████                                             | 8/20 [03:35<05:32, 27.70s/it]len=16000:  45%|█████████████████████████████████▊                                         | 9/20 [04:02<05:03, 27.61s/it]len=16000:  50%|█████████████████████████████████████                                     | 10/20 [04:32<04:41, 28.19s/it]len=16000:  55%|████████████████████████████████████████▋                                 | 11/20 [04:59<04:11, 27.97s/it]len=16000:  60%|████████████████████████████████████████████▍                             | 12/20 [05:25<03:39, 27.39s/it]len=16000:  65%|████████████████████████████████████████████████                          | 13/20 [05:52<03:10, 27.28s/it]len=16000:  70%|███████████████████████████████████████████████████▊                      | 14/20 [06:19<02:41, 26.96s/it]len=16000:  75%|███████████████████████████████████████████████████████▌                  | 15/20 [06:48<02:18, 27.70s/it]len=16000:  80%|███████████████████████████████████████████████████████████▏              | 16/20 [07:15<01:50, 27.51s/it]len=16000:  85%|██████████████████████████████████████████████████████████████▉           | 17/20 [07:43<01:23, 27.68s/it]len=16000:  90%|██████████████████████████████████████████████████████████████████▌       | 18/20 [08:10<00:54, 27.46s/it]len=16000:  95%|██████████████████████████████████████████████████████████████████████▎   | 19/20 [08:40<00:28, 28.07s/it]len=16000: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [09:07<00:00, 28.00s/it]len=16000: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [09:07<00:00, 27.40s/it]

Generated 257 tokens in 12.53s. 
Token/sec: 20.52
Average acceptance length: 0.512

Generated 257 tokens in 13.85s. 
Token/sec: 18.55
Average acceptance length: 0.512

Generated 257 tokens in 12.76s. 
Token/sec: 20.14
Average acceptance length: 0.460

Generated 257 tokens in 12.74s. 
Token/sec: 20.17
Average acceptance length: 0.460

Generated 257 tokens in 13.89s. 
Token/sec: 18.51
Average acceptance length: 0.477

Generated 257 tokens in 12.53s. 
Token/sec: 20.5
Average acceptance length: 0.477

Generated 258 tokens in 12.23s. 
Token/sec: 21.1
Average acceptance length: 0.536

Generated 258 tokens in 13.58s. 
Token/sec: 19.0
Average acceptance length: 0.536

Generated 257 tokens in 12.61s. 
Token/sec: 20.38
Average acceptance length: 0.486

Generated 257 tokens in 13.92s. 
Token/sec: 18.46
Average acceptance length: 0.486

Generated 257 tokens in 13.38s. 
Token/sec: 19.21
Average acceptance length: 0.404

Generated 257 tokens in 13.38s. 
Token/sec: 19.21
Average acceptance length: 0.404

Generated 257 tokens in 15.45s. 
Token/sec: 16.64
Average acceptance length: 0.420

Generated 257 tokens in 14.11s. 
Token/sec: 18.21
Average acceptance length: 0.420

Generated 258 tokens in 14.77s. 
Token/sec: 17.47
Average acceptance length: 0.441

Generated 258 tokens in 13.42s. 
Token/sec: 19.23
Average acceptance length: 0.441

Generated 258 tokens in 14.39s. 
Token/sec: 17.93
Average acceptance length: 0.433

Generated 258 tokens in 13.00s. 
Token/sec: 19.84
Average acceptance length: 0.433

Generated 257 tokens in 13.99s. 
Token/sec: 18.37
Average acceptance length: 0.486

Generated 257 tokens in 15.45s. 
Token/sec: 16.64
Average acceptance length: 0.486

Generated 257 tokens in 13.06s. 
Token/sec: 19.68
Average acceptance length: 0.521

Generated 257 tokens in 14.38s. 
Token/sec: 17.87
Average acceptance length: 0.521

Generated 257 tokens in 13.02s. 
Token/sec: 19.73
Average acceptance length: 0.539

Generated 257 tokens in 13.02s. 
Token/sec: 19.74
Average acceptance length: 0.539

Generated 258 tokens in 14.16s. 
Token/sec: 18.22
Average acceptance length: 0.449

Generated 258 tokens in 12.83s. 
Token/sec: 20.11
Average acceptance length: 0.449

Generated 257 tokens in 13.80s. 
Token/sec: 18.63
Average acceptance length: 0.477

Generated 257 tokens in 12.40s. 
Token/sec: 20.72
Average acceptance length: 0.477

Generated 257 tokens in 14.00s. 
Token/sec: 18.36
Average acceptance length: 0.452

Generated 257 tokens in 15.38s. 
Token/sec: 16.71
Average acceptance length: 0.452

Generated 257 tokens in 12.85s. 
Token/sec: 19.99
Average acceptance length: 0.428

Generated 257 tokens in 14.19s. 
Token/sec: 18.12
Average acceptance length: 0.428

Generated 257 tokens in 13.35s. 
Token/sec: 19.25
Average acceptance length: 0.477

Generated 257 tokens in 14.69s. 
Token/sec: 17.49
Average acceptance length: 0.477

Generated 258 tokens in 13.45s. 
Token/sec: 19.19
Average acceptance length: 0.449

Generated 258 tokens in 13.45s. 
Token/sec: 19.18
Average acceptance length: 0.449

Generated 257 tokens in 15.41s. 
Token/sec: 16.68
Average acceptance length: 0.389

Generated 257 tokens in 14.06s. 
Token/sec: 18.28
Average acceptance length: 0.389

Generated 257 tokens in 14.58s. 
Token/sec: 17.63
Average acceptance length: 0.452

Generated 257 tokens in 13.24s. 
Token/sec: 19.41
Average acceptance length: 0.452
Experiment complete!
JSON decode error in .DS_Store line 0: Expecting value: line 1 column 1 (char 0)
Loading checkpoint shards:   0%|                                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|███████████████                                             | 1/4 [00:00<00:02,  1.40it/s]Loading checkpoint shards:  50%|██████████████████████████████                              | 2/4 [00:01<00:01,  1.40it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████               | 3/4 [00:02<00:00,  1.42it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.97it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.72it/s]
/home/hjkim/workspace/SpecExtend_Reb/eagle_3/model_eagle.py:109: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ea_layer_state_dict = torch.load(load_model_path,
Warming up GPUs...
Warmup complete!
len=1024:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=1024:   5%|███▊                                                                        | 1/20 [00:07<02:22,  7.49s/it]len=1024:  10%|███████▌                                                                    | 2/20 [00:13<01:57,  6.55s/it]len=1024:  15%|███████████▍                                                                | 3/20 [00:19<01:46,  6.25s/it]len=1024:  20%|███████████████▏                                                            | 4/20 [00:25<01:37,  6.11s/it]len=1024:  25%|███████████████████                                                         | 5/20 [00:31<01:33,  6.20s/it]len=1024:  30%|██████████████████████▊                                                     | 6/20 [00:39<01:33,  6.71s/it]len=1024:  35%|██████████████████████████▌                                                 | 7/20 [00:45<01:25,  6.61s/it]len=1024:  40%|██████████████████████████████▍                                             | 8/20 [00:52<01:18,  6.53s/it]len=1024:  45%|██████████████████████████████████▏                                         | 9/20 [00:58<01:10,  6.37s/it]len=1024:  50%|█████████████████████████████████████▌                                     | 10/20 [01:03<01:02,  6.22s/it]len=1024:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:10<00:57,  6.40s/it]len=1024:  60%|█████████████████████████████████████████████                              | 12/20 [01:16<00:49,  6.22s/it]len=1024:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:22<00:42,  6.13s/it]len=1024:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:27<00:35,  5.94s/it]len=1024:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:34<00:30,  6.08s/it]len=1024:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:39<00:23,  5.92s/it]len=1024:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:47<00:18,  6.28s/it]len=1024:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [01:52<00:12,  6.05s/it]len=1024:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [01:58<00:05,  5.96s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:04<00:00,  5.92s/it]len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:04<00:00,  6.21s/it]

Generated 260 tokens in 4.47s. 
Token/sec: 58.14
Average acceptance length: 1.430

Generated 260 tokens in 3.02s. 
Token/sec: 86.23
Average acceptance length: 1.430

Generated 260 tokens in 2.94s. 
Token/sec: 88.36
Average acceptance length: 1.430

Generated 260 tokens in 2.94s. 
Token/sec: 88.33
Average acceptance length: 1.430

Generated 260 tokens in 2.94s. 
Token/sec: 88.38
Average acceptance length: 1.430

Generated 260 tokens in 2.94s. 
Token/sec: 88.35
Average acceptance length: 1.430

Generated 260 tokens in 2.94s. 
Token/sec: 88.3
Average acceptance length: 1.430

Generated 260 tokens in 2.94s. 
Token/sec: 88.33
Average acceptance length: 1.430

Generated 257 tokens in 3.18s. 
Token/sec: 80.76
Average acceptance length: 1.216

Generated 257 tokens in 3.18s. 
Token/sec: 80.73
Average acceptance length: 1.216

Generated 257 tokens in 3.18s. 
Token/sec: 80.75
Average acceptance length: 1.216

Generated 257 tokens in 4.52s. 
Token/sec: 56.9
Average acceptance length: 1.216

Generated 257 tokens in 3.22s. 
Token/sec: 79.75
Average acceptance length: 1.216

Generated 257 tokens in 3.18s. 
Token/sec: 80.77
Average acceptance length: 1.216

Generated 257 tokens in 3.18s. 
Token/sec: 80.77
Average acceptance length: 1.216

Generated 257 tokens in 3.18s. 
Token/sec: 80.78
Average acceptance length: 1.216

Generated 257 tokens in 3.07s. 
Token/sec: 83.63
Average acceptance length: 1.448

Generated 257 tokens in 2.93s. 
Token/sec: 87.85
Average acceptance length: 1.448

Generated 259 tokens in 2.87s. 
Token/sec: 90.36
Average acceptance length: 1.539

Generated 259 tokens in 3.03s. 
Token/sec: 85.45
Average acceptance length: 1.539

Generated 259 tokens in 2.72s. 
Token/sec: 95.14
Average acceptance length: 1.726

Generated 259 tokens in 4.07s. 
Token/sec: 63.6
Average acceptance length: 1.726

Generated 258 tokens in 2.90s. 
Token/sec: 88.86
Average acceptance length: 1.505

Generated 258 tokens in 2.90s. 
Token/sec: 88.85
Average acceptance length: 1.505

Generated 259 tokens in 2.95s. 
Token/sec: 87.67
Average acceptance length: 1.490

Generated 259 tokens in 2.95s. 
Token/sec: 87.65
Average acceptance length: 1.490

Generated 259 tokens in 2.76s. 
Token/sec: 93.82
Average acceptance length: 1.643

Generated 259 tokens in 2.76s. 
Token/sec: 93.83
Average acceptance length: 1.643

Generated 258 tokens in 3.19s. 
Token/sec: 80.87
Average acceptance length: 1.263

Generated 258 tokens in 3.19s. 
Token/sec: 80.83
Average acceptance length: 1.263

Generated 260 tokens in 2.78s. 
Token/sec: 93.51
Average acceptance length: 1.653

Generated 260 tokens in 2.78s. 
Token/sec: 93.56
Average acceptance length: 1.653

Generated 259 tokens in 4.23s. 
Token/sec: 61.21
Average acceptance length: 1.564

Generated 259 tokens in 2.89s. 
Token/sec: 89.77
Average acceptance length: 1.564

Generated 258 tokens in 2.76s. 
Token/sec: 93.52
Average acceptance length: 1.633

Generated 258 tokens in 2.76s. 
Token/sec: 93.56
Average acceptance length: 1.633

Generated 258 tokens in 2.88s. 
Token/sec: 89.74
Average acceptance length: 1.529

Generated 258 tokens in 2.88s. 
Token/sec: 89.73
Average acceptance length: 1.529

Generated 257 tokens in 2.91s. 
Token/sec: 88.23
Average acceptance length: 1.471

Generated 257 tokens in 2.91s. 
Token/sec: 88.17
Average acceptance length: 1.471
Warming up GPUs...
Warmup complete!
len=2048:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=2048:   5%|███▊                                                                        | 1/20 [00:06<02:08,  6.79s/it]len=2048:  10%|███████▌                                                                    | 2/20 [00:15<02:19,  7.73s/it]len=2048:  15%|███████████▍                                                                | 3/20 [00:22<02:06,  7.42s/it]len=2048:  20%|███████████████▏                                                            | 4/20 [00:29<01:56,  7.28s/it]len=2048:  25%|███████████████████                                                         | 5/20 [00:36<01:46,  7.07s/it]len=2048:  30%|██████████████████████▊                                                     | 6/20 [00:42<01:37,  6.95s/it]len=2048:  35%|██████████████████████████▌                                                 | 7/20 [00:50<01:34,  7.24s/it]len=2048:  40%|██████████████████████████████▍                                             | 8/20 [00:56<01:23,  6.98s/it]len=2048:  45%|██████████████████████████████████▏                                         | 9/20 [01:03<01:16,  6.95s/it]len=2048:  50%|█████████████████████████████████████▌                                     | 10/20 [01:10<01:09,  6.93s/it]len=2048:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:17<01:02,  6.92s/it]len=2048:  60%|█████████████████████████████████████████████                              | 12/20 [01:25<00:58,  7.32s/it]len=2048:  65%|████████████████████████████████████████████████▊                          | 13/20 [01:32<00:49,  7.03s/it]len=2048:  70%|████████████████████████████████████████████████████▌                      | 14/20 [01:38<00:40,  6.82s/it]len=2048:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [01:44<00:33,  6.68s/it]len=2048:  80%|████████████████████████████████████████████████████████████               | 16/20 [01:51<00:26,  6.58s/it]len=2048:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [01:58<00:20,  6.92s/it]len=2048:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [02:06<00:13,  6.97s/it]len=2048:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [02:12<00:06,  6.77s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:18<00:00,  6.55s/it]len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [02:18<00:00,  6.92s/it]

Generated 259 tokens in 3.37s. 
Token/sec: 76.8
Average acceptance length: 1.467

Generated 259 tokens in 3.41s. 
Token/sec: 75.98
Average acceptance length: 1.443

Generated 257 tokens in 3.52s. 
Token/sec: 72.92
Average acceptance length: 1.315

Generated 257 tokens in 4.87s. 
Token/sec: 52.8
Average acceptance length: 1.315

Generated 257 tokens in 3.52s. 
Token/sec: 72.94
Average acceptance length: 1.315

Generated 257 tokens in 3.53s. 
Token/sec: 72.83
Average acceptance length: 1.315

Generated 257 tokens in 3.53s. 
Token/sec: 72.82
Average acceptance length: 1.315

Generated 257 tokens in 3.53s. 
Token/sec: 72.9
Average acceptance length: 1.315

Generated 257 tokens in 3.35s. 
Token/sec: 76.71
Average acceptance length: 1.425

Generated 257 tokens in 3.35s. 
Token/sec: 76.67
Average acceptance length: 1.425

Generated 257 tokens in 3.35s. 
Token/sec: 76.67
Average acceptance length: 1.425

Generated 257 tokens in 3.35s. 
Token/sec: 76.64
Average acceptance length: 1.425

Generated 259 tokens in 4.59s. 
Token/sec: 56.46
Average acceptance length: 1.564

Generated 259 tokens in 3.25s. 
Token/sec: 79.81
Average acceptance length: 1.564

Generated 259 tokens in 3.21s. 
Token/sec: 80.74
Average acceptance length: 1.616

Generated 259 tokens in 3.21s. 
Token/sec: 80.73
Average acceptance length: 1.616

Generated 260 tokens in 3.44s. 
Token/sec: 75.51
Average acceptance length: 1.407

Generated 260 tokens in 3.44s. 
Token/sec: 75.53
Average acceptance length: 1.407

Generated 260 tokens in 3.44s. 
Token/sec: 75.53
Average acceptance length: 1.407

Generated 260 tokens in 3.44s. 
Token/sec: 75.55
Average acceptance length: 1.407

Generated 260 tokens in 3.44s. 
Token/sec: 75.59
Average acceptance length: 1.407

Generated 260 tokens in 3.45s. 
Token/sec: 75.39
Average acceptance length: 1.407

Generated 260 tokens in 4.78s. 
Token/sec: 54.38
Average acceptance length: 1.407

Generated 260 tokens in 3.44s. 
Token/sec: 75.57
Average acceptance length: 1.407

Generated 258 tokens in 3.17s. 
Token/sec: 81.31
Average acceptance length: 1.606

Generated 258 tokens in 3.17s. 
Token/sec: 81.28
Average acceptance length: 1.606

Generated 258 tokens in 3.17s. 
Token/sec: 81.32
Average acceptance length: 1.606

Generated 258 tokens in 3.17s. 
Token/sec: 81.29
Average acceptance length: 1.606

Generated 258 tokens in 3.17s. 
Token/sec: 81.27
Average acceptance length: 1.606

Generated 258 tokens in 3.17s. 
Token/sec: 81.31
Average acceptance length: 1.606

Generated 258 tokens in 3.17s. 
Token/sec: 81.28
Average acceptance length: 1.606

Generated 258 tokens in 3.17s. 
Token/sec: 81.29
Average acceptance length: 1.606

Generated 258 tokens in 4.53s. 
Token/sec: 56.98
Average acceptance length: 1.606

Generated 258 tokens in 3.18s. 
Token/sec: 81.25
Average acceptance length: 1.606

Generated 258 tokens in 3.53s. 
Token/sec: 73.01
Average acceptance length: 1.304

Generated 258 tokens in 3.53s. 
Token/sec: 73.01
Average acceptance length: 1.304

Generated 260 tokens in 3.15s. 
Token/sec: 82.51
Average acceptance length: 1.653

Generated 260 tokens in 3.15s. 
Token/sec: 82.52
Average acceptance length: 1.653

Generated 259 tokens in 3.02s. 
Token/sec: 85.84
Average acceptance length: 1.785

Generated 259 tokens in 3.02s. 
Token/sec: 85.85
Average acceptance length: 1.785
Warming up GPUs...
Warmup complete!
len=4096:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=4096:   5%|███▊                                                                        | 1/20 [00:12<03:59, 12.58s/it]len=4096:  10%|███████▌                                                                    | 2/20 [00:23<03:27, 11.51s/it]len=4096:  15%|███████████▍                                                                | 3/20 [00:34<03:09, 11.16s/it]len=4096:  20%|███████████████▏                                                            | 4/20 [00:46<03:04, 11.53s/it]len=4096:  25%|███████████████████                                                         | 5/20 [00:56<02:48, 11.25s/it]len=4096:  30%|██████████████████████▊                                                     | 6/20 [01:07<02:35, 11.09s/it]len=4096:  35%|██████████████████████████▌                                                 | 7/20 [01:20<02:29, 11.51s/it]len=4096:  40%|██████████████████████████████▍                                             | 8/20 [01:31<02:17, 11.45s/it]len=4096:  45%|██████████████████████████████████▏                                         | 9/20 [01:42<02:05, 11.42s/it]len=4096:  50%|█████████████████████████████████████▌                                     | 10/20 [01:55<01:58, 11.81s/it]len=4096:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:06<01:45, 11.71s/it]len=4096:  60%|█████████████████████████████████████████████                              | 12/20 [02:18<01:32, 11.56s/it]len=4096:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:31<01:24, 12.14s/it]len=4096:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:43<01:12, 12.10s/it]len=4096:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:55<00:59, 11.91s/it]len=4096:  80%|████████████████████████████████████████████████████████████               | 16/20 [03:05<00:46, 11.58s/it]len=4096:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [03:16<00:34, 11.34s/it]len=4096:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [03:28<00:23, 11.58s/it]len=4096:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:39<00:11, 11.35s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:50<00:00, 11.19s/it]len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:50<00:00, 11.52s/it]

Generated 258 tokens in 6.97s. 
Token/sec: 37.01
Average acceptance length: 0.709

Generated 258 tokens in 5.60s. 
Token/sec: 46.05
Average acceptance length: 0.709

Generated 257 tokens in 5.37s. 
Token/sec: 47.83
Average acceptance length: 0.823

Generated 257 tokens in 5.37s. 
Token/sec: 47.83
Average acceptance length: 0.823

Generated 257 tokens in 5.38s. 
Token/sec: 47.79
Average acceptance length: 0.823

Generated 257 tokens in 5.37s. 
Token/sec: 47.85
Average acceptance length: 0.823

Generated 257 tokens in 6.71s. 
Token/sec: 38.32
Average acceptance length: 0.823

Generated 257 tokens in 5.37s. 
Token/sec: 47.84
Average acceptance length: 0.823

Generated 257 tokens in 5.37s. 
Token/sec: 47.86
Average acceptance length: 0.823

Generated 257 tokens in 5.38s. 
Token/sec: 47.74
Average acceptance length: 0.823

Generated 257 tokens in 5.38s. 
Token/sec: 47.77
Average acceptance length: 0.823

Generated 257 tokens in 5.38s. 
Token/sec: 47.79
Average acceptance length: 0.823

Generated 257 tokens in 6.85s. 
Token/sec: 37.49
Average acceptance length: 0.713

Generated 257 tokens in 5.50s. 
Token/sec: 46.7
Average acceptance length: 0.713

Generated 258 tokens in 5.67s. 
Token/sec: 45.51
Average acceptance length: 0.675

Generated 258 tokens in 5.67s. 
Token/sec: 45.51
Average acceptance length: 0.675

Generated 258 tokens in 5.67s. 
Token/sec: 45.53
Average acceptance length: 0.675

Generated 258 tokens in 5.67s. 
Token/sec: 45.53
Average acceptance length: 0.675

Generated 258 tokens in 7.00s. 
Token/sec: 36.84
Average acceptance length: 0.675

Generated 258 tokens in 5.67s. 
Token/sec: 45.51
Average acceptance length: 0.675

Generated 258 tokens in 5.74s. 
Token/sec: 44.95
Average acceptance length: 0.675

Generated 258 tokens in 5.73s. 
Token/sec: 45.03
Average acceptance length: 0.675

Generated 258 tokens in 5.61s. 
Token/sec: 46.01
Average acceptance length: 0.675

Generated 258 tokens in 5.61s. 
Token/sec: 46.03
Average acceptance length: 0.675

Generated 257 tokens in 7.36s. 
Token/sec: 34.94
Average acceptance length: 0.567

Generated 257 tokens in 6.09s. 
Token/sec: 42.2
Average acceptance length: 0.567

Generated 257 tokens in 6.00s. 
Token/sec: 42.83
Average acceptance length: 0.567

Generated 257 tokens in 6.00s. 
Token/sec: 42.84
Average acceptance length: 0.567

Generated 257 tokens in 5.06s. 
Token/sec: 50.81
Average acceptance length: 0.932

Generated 257 tokens in 6.41s. 
Token/sec: 40.09
Average acceptance length: 0.932

Generated 257 tokens in 5.40s. 
Token/sec: 47.62
Average acceptance length: 0.797

Generated 257 tokens in 5.40s. 
Token/sec: 47.6
Average acceptance length: 0.797

Generated 257 tokens in 5.40s. 
Token/sec: 47.62
Average acceptance length: 0.797

Generated 257 tokens in 5.40s. 
Token/sec: 47.64
Average acceptance length: 0.797

Generated 257 tokens in 5.39s. 
Token/sec: 47.64
Average acceptance length: 0.797

Generated 257 tokens in 6.73s. 
Token/sec: 38.17
Average acceptance length: 0.797

Generated 257 tokens in 5.40s. 
Token/sec: 47.6
Average acceptance length: 0.797

Generated 257 tokens in 5.40s. 
Token/sec: 47.62
Average acceptance length: 0.797

Generated 257 tokens in 5.40s. 
Token/sec: 47.62
Average acceptance length: 0.797

Generated 257 tokens in 5.40s. 
Token/sec: 47.61
Average acceptance length: 0.797
Warming up GPUs...
Warmup complete!
len=8192:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]len=8192:   5%|███▊                                                                        | 1/20 [00:19<06:04, 19.19s/it]len=8192:  10%|███████▌                                                                    | 2/20 [00:37<05:31, 18.44s/it]len=8192:  15%|███████████▍                                                                | 3/20 [00:55<05:14, 18.49s/it]len=8192:  20%|███████████████▏                                                            | 4/20 [01:12<04:48, 18.02s/it]len=8192:  25%|███████████████████                                                         | 5/20 [01:31<04:35, 18.34s/it]len=8192:  30%|██████████████████████▊                                                     | 6/20 [01:51<04:21, 18.69s/it]len=8192:  35%|██████████████████████████▌                                                 | 7/20 [02:09<04:00, 18.48s/it]len=8192:  40%|██████████████████████████████▍                                             | 8/20 [02:28<03:45, 18.77s/it]len=8192:  45%|██████████████████████████████████▏                                         | 9/20 [02:45<03:19, 18.13s/it]len=8192:  50%|█████████████████████████████████████▌                                     | 10/20 [03:05<03:06, 18.63s/it]len=8192:  55%|█████████████████████████████████████████▎                                 | 11/20 [03:21<02:42, 18.04s/it]len=8192:  60%|█████████████████████████████████████████████                              | 12/20 [03:41<02:29, 18.64s/it]len=8192:  65%|████████████████████████████████████████████████▊                          | 13/20 [03:59<02:07, 18.27s/it]len=8192:  70%|████████████████████████████████████████████████████▌                      | 14/20 [04:17<01:50, 18.34s/it]len=8192:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [04:34<01:29, 17.92s/it]len=8192:  80%|████████████████████████████████████████████████████████████               | 16/20 [04:53<01:12, 18.23s/it]len=8192:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [05:11<00:54, 18.15s/it]len=8192:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [05:28<00:35, 17.69s/it]len=8192:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [05:46<00:17, 17.93s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [06:03<00:00, 17.70s/it]len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [06:03<00:00, 18.20s/it]

Generated 257 tokens in 10.27s. 
Token/sec: 25.03
Average acceptance length: 0.460

Generated 257 tokens in 8.90s. 
Token/sec: 28.86
Average acceptance length: 0.460

Generated 257 tokens in 9.00s. 
Token/sec: 28.54
Average acceptance length: 0.460

Generated 257 tokens in 8.90s. 
Token/sec: 28.86
Average acceptance length: 0.460

Generated 257 tokens in 9.93s. 
Token/sec: 25.89
Average acceptance length: 0.521

Generated 257 tokens in 8.61s. 
Token/sec: 29.86
Average acceptance length: 0.521

Generated 257 tokens in 8.65s. 
Token/sec: 29.73
Average acceptance length: 0.548

Generated 257 tokens in 8.64s. 
Token/sec: 29.75
Average acceptance length: 0.548

Generated 257 tokens in 10.12s. 
Token/sec: 25.39
Average acceptance length: 0.530

Generated 257 tokens in 8.75s. 
Token/sec: 29.36
Average acceptance length: 0.530

Generated 258 tokens in 9.01s. 
Token/sec: 28.62
Average acceptance length: 0.474

Generated 258 tokens in 10.34s. 
Token/sec: 24.94
Average acceptance length: 0.474

Generated 258 tokens in 9.02s. 
Token/sec: 28.62
Average acceptance length: 0.474

Generated 258 tokens in 9.01s. 
Token/sec: 28.62
Average acceptance length: 0.474

Generated 258 tokens in 9.01s. 
Token/sec: 28.62
Average acceptance length: 0.474

Generated 258 tokens in 10.36s. 
Token/sec: 24.91
Average acceptance length: 0.474

Generated 257 tokens in 8.35s. 
Token/sec: 30.76
Average acceptance length: 0.616

Generated 257 tokens in 8.36s. 
Token/sec: 30.74
Average acceptance length: 0.616

Generated 257 tokens in 10.55s. 
Token/sec: 24.37
Average acceptance length: 0.436

Generated 257 tokens in 9.17s. 
Token/sec: 28.02
Average acceptance length: 0.436

Generated 257 tokens in 8.35s. 
Token/sec: 30.79
Average acceptance length: 0.606

Generated 257 tokens in 8.33s. 
Token/sec: 30.84
Average acceptance length: 0.606

Generated 257 tokens in 10.66s. 
Token/sec: 24.11
Average acceptance length: 0.460

Generated 257 tokens in 9.32s. 
Token/sec: 27.58
Average acceptance length: 0.460

Generated 257 tokens in 8.71s. 
Token/sec: 29.52
Average acceptance length: 0.521

Generated 257 tokens in 8.71s. 
Token/sec: 29.52
Average acceptance length: 0.521

Generated 258 tokens in 9.92s. 
Token/sec: 26.01
Average acceptance length: 0.593

Generated 258 tokens in 8.56s. 
Token/sec: 30.14
Average acceptance length: 0.593

Generated 257 tokens in 8.47s. 
Token/sec: 30.36
Average acceptance length: 0.577

Generated 257 tokens in 8.47s. 
Token/sec: 30.36
Average acceptance length: 0.577

Generated 258 tokens in 10.14s. 
Token/sec: 25.45
Average acceptance length: 0.527

Generated 258 tokens in 8.79s. 
Token/sec: 29.35
Average acceptance length: 0.527

Generated 258 tokens in 8.31s. 
Token/sec: 31.04
Average acceptance length: 0.613

Generated 258 tokens in 9.64s. 
Token/sec: 26.76
Average acceptance length: 0.613

Generated 258 tokens in 8.29s. 
Token/sec: 31.11
Average acceptance length: 0.613

Generated 258 tokens in 8.32s. 
Token/sec: 31.02
Average acceptance length: 0.613

Generated 258 tokens in 8.56s. 
Token/sec: 30.14
Average acceptance length: 0.564

Generated 258 tokens in 9.90s. 
Token/sec: 26.07
Average acceptance length: 0.564

Generated 258 tokens in 8.57s. 
Token/sec: 30.1
Average acceptance length: 0.593

Generated 258 tokens in 8.58s. 
Token/sec: 30.06
Average acceptance length: 0.593
Warming up GPUs...
Warmup complete!
len=16384:   0%|                                                                                   | 0/20 [00:00<?, ?it/s]len=16384:   5%|███▊                                                                       | 1/20 [00:29<09:14, 29.19s/it]len=16384:  10%|███████▌                                                                   | 2/20 [00:57<08:39, 28.89s/it]len=16384:  15%|███████████▎                                                               | 3/20 [01:27<08:13, 29.06s/it]len=16384:  20%|███████████████                                                            | 4/20 [01:54<07:33, 28.33s/it]len=16384:  25%|██████████████████▊                                                        | 5/20 [02:22<07:02, 28.18s/it]len=16384:  30%|██████████████████████▌                                                    | 6/20 [02:50<06:32, 28.05s/it]len=16384:  35%|██████████████████████████▎                                                | 7/20 [03:18<06:05, 28.14s/it]len=16384:  40%|██████████████████████████████                                             | 8/20 [03:47<05:41, 28.45s/it]len=16384:  45%|█████████████████████████████████▊                                         | 9/20 [04:16<05:16, 28.74s/it]len=16384:  50%|█████████████████████████████████████                                     | 10/20 [04:47<04:52, 29.24s/it]len=16384:  55%|████████████████████████████████████████▋                                 | 11/20 [05:18<04:27, 29.72s/it]len=16384:  60%|████████████████████████████████████████████▍                             | 12/20 [05:48<04:00, 30.02s/it]len=16384:  65%|████████████████████████████████████████████████                          | 13/20 [06:18<03:30, 30.04s/it]len=16384:  70%|███████████████████████████████████████████████████▊                      | 14/20 [06:49<03:01, 30.31s/it]len=16384:  75%|███████████████████████████████████████████████████████▌                  | 15/20 [07:17<02:27, 29.51s/it]len=16384:  80%|███████████████████████████████████████████████████████████▏              | 16/20 [07:46<01:57, 29.43s/it]len=16384:  85%|██████████████████████████████████████████████████████████████▉           | 17/20 [08:17<01:29, 29.72s/it]len=16384:  90%|██████████████████████████████████████████████████████████████████▌       | 18/20 [08:47<00:59, 29.96s/it]len=16384:  95%|██████████████████████████████████████████████████████████████████████▎   | 19/20 [09:15<00:29, 29.37s/it]len=16384: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [09:46<00:00, 29.79s/it]len=16384: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [09:46<00:00, 29.32s/it]

Generated 257 tokens in 15.25s. 
Token/sec: 16.85
Average acceptance length: 0.412

Generated 257 tokens in 13.90s. 
Token/sec: 18.48
Average acceptance length: 0.412

Generated 257 tokens in 15.00s. 
Token/sec: 17.13
Average acceptance length: 0.436

Generated 257 tokens in 13.65s. 
Token/sec: 18.83
Average acceptance length: 0.436

Generated 257 tokens in 15.28s. 
Token/sec: 16.82
Average acceptance length: 0.412

Generated 257 tokens in 13.95s. 
Token/sec: 18.42
Average acceptance length: 0.412

Generated 258 tokens in 12.92s. 
Token/sec: 19.97
Average acceptance length: 0.536

Generated 258 tokens in 14.26s. 
Token/sec: 18.09
Average acceptance length: 0.536

Generated 257 tokens in 13.26s. 
Token/sec: 19.39
Average acceptance length: 0.469

Generated 257 tokens in 14.62s. 
Token/sec: 17.58
Average acceptance length: 0.469

Generated 257 tokens in 13.89s. 
Token/sec: 18.5
Average acceptance length: 0.436

Generated 257 tokens in 13.89s. 
Token/sec: 18.51
Average acceptance length: 0.436

Generated 257 tokens in 14.81s. 
Token/sec: 17.35
Average acceptance length: 0.503

Generated 257 tokens in 13.47s. 
Token/sec: 19.07
Average acceptance length: 0.503

Generated 257 tokens in 15.22s. 
Token/sec: 16.89
Average acceptance length: 0.428

Generated 257 tokens in 13.87s. 
Token/sec: 18.53
Average acceptance length: 0.428

Generated 257 tokens in 15.34s. 
Token/sec: 16.75
Average acceptance length: 0.486

Generated 257 tokens in 14.01s. 
Token/sec: 18.34
Average acceptance length: 0.486

Generated 257 tokens in 14.49s. 
Token/sec: 17.74
Average acceptance length: 0.444

Generated 257 tokens in 15.82s. 
Token/sec: 16.24
Average acceptance length: 0.444

Generated 257 tokens in 14.70s. 
Token/sec: 17.48
Average acceptance length: 0.404

Generated 257 tokens in 16.08s. 
Token/sec: 15.98
Average acceptance length: 0.404

Generated 257 tokens in 14.66s. 
Token/sec: 17.53
Average acceptance length: 0.404

Generated 257 tokens in 16.00s. 
Token/sec: 16.06
Average acceptance length: 0.404

Generated 257 tokens in 14.35s. 
Token/sec: 17.9
Average acceptance length: 0.444

Generated 257 tokens in 15.69s. 
Token/sec: 16.38
Average acceptance length: 0.444

Generated 257 tokens in 14.80s. 
Token/sec: 17.36
Average acceptance length: 0.367

Generated 257 tokens in 16.11s. 
Token/sec: 15.96
Average acceptance length: 0.367

Generated 258 tokens in 13.81s. 
Token/sec: 18.68
Average acceptance length: 0.491

Generated 258 tokens in 13.80s. 
Token/sec: 18.69
Average acceptance length: 0.491

Generated 257 tokens in 13.62s. 
Token/sec: 18.87
Average acceptance length: 0.503

Generated 257 tokens in 15.59s. 
Token/sec: 16.48
Average acceptance length: 0.503

Generated 257 tokens in 14.51s. 
Token/sec: 17.72
Average acceptance length: 0.389

Generated 257 tokens in 15.85s. 
Token/sec: 16.22
Average acceptance length: 0.389

Generated 258 tokens in 14.59s. 
Token/sec: 17.69
Average acceptance length: 0.410

Generated 258 tokens in 15.92s. 
Token/sec: 16.21
Average acceptance length: 0.410

Generated 257 tokens in 13.94s. 
Token/sec: 18.43
Average acceptance length: 0.460

Generated 257 tokens in 14.00s. 
Token/sec: 18.36
Average acceptance length: 0.460

Generated 257 tokens in 16.05s. 
Token/sec: 16.01
Average acceptance length: 0.412

Generated 257 tokens in 14.68s. 
Token/sec: 17.51
Average acceptance length: 0.412
Experiment complete!
