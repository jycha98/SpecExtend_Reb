nohup: ignoring input
Loading checkpoint shards:   0%|                                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|███████████████                                             | 1/4 [00:00<00:02,  1.45it/s]Loading checkpoint shards:  50%|██████████████████████████████                              | 2/4 [00:01<00:01,  1.45it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████               | 3/4 [00:02<00:00,  1.46it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  2.06it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.79it/s]
→ length=1024, #samples=20
Len=1024:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
Len=1024:   5%|███▊                                                                        | 1/20 [00:10<03:28, 10.98s/it]Len=1024:  10%|███████▌                                                                    | 2/20 [00:20<03:00, 10.01s/it]Len=1024:  15%|███████████▍                                                                | 3/20 [00:29<02:44,  9.67s/it]Len=1024:  20%|███████████████▏                                                            | 4/20 [00:40<02:41, 10.07s/it]Len=1024:  25%|███████████████████                                                         | 5/20 [00:49<02:27,  9.83s/it]Len=1024:  30%|██████████████████████▊                                                     | 6/20 [00:58<02:15,  9.64s/it]Len=1024:  35%|██████████████████████████▌                                                 | 7/20 [01:08<02:03,  9.53s/it]Len=1024:  40%|██████████████████████████████▍                                             | 8/20 [01:18<01:58,  9.90s/it]Len=1024:  45%|██████████████████████████████████▏                                         | 9/20 [01:28<01:46,  9.72s/it]Len=1024:  50%|█████████████████████████████████████▌                                     | 10/20 [01:37<01:35,  9.60s/it]Len=1024:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:46<01:25,  9.50s/it]Len=1024:  60%|█████████████████████████████████████████████                              | 12/20 [01:56<01:15,  9.44s/it]Len=1024:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:05<01:05,  9.40s/it]Len=1024:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:14<00:56,  9.37s/it]Len=1024:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:26<00:51, 10.21s/it]Len=1024:  80%|████████████████████████████████████████████████████████████               | 16/20 [02:36<00:39,  9.94s/it]Len=1024:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [02:45<00:29,  9.75s/it]Len=1024:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [02:54<00:19,  9.62s/it]Len=1024:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:05<00:09,  9.93s/it]Len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:14<00:00,  9.73s/it]Len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:14<00:00,  9.74s/it]
Run 1 tokens/sec: 40.42

Run 2 tokens/sec: 55.24

Run 1 tokens/sec: 54.89

Run 2 tokens/sec: 54.91

Run 1 tokens/sec: 55.18

Run 2 tokens/sec: 55.21

Run 1 tokens/sec: 54.79

Run 2 tokens/sec: 42.57

Run 1 tokens/sec: 53.90

Run 2 tokens/sec: 55.06

Run 1 tokens/sec: 55.21

Run 2 tokens/sec: 55.19

Run 1 tokens/sec: 55.11

Run 2 tokens/sec: 54.93

Run 1 tokens/sec: 42.76

Run 2 tokens/sec: 54.36

Run 1 tokens/sec: 54.72

Run 2 tokens/sec: 55.09

Run 1 tokens/sec: 55.02

Run 2 tokens/sec: 55.03

Run 1 tokens/sec: 55.10

Run 2 tokens/sec: 55.09

Run 1 tokens/sec: 54.98

Run 2 tokens/sec: 55.18

Run 1 tokens/sec: 54.95

Run 2 tokens/sec: 54.93

Run 1 tokens/sec: 55.07

Run 2 tokens/sec: 55.05

Run 1 tokens/sec: 54.93

Run 2 tokens/sec: 34.22

Run 1 tokens/sec: 54.97

Run 2 tokens/sec: 54.98

Run 1 tokens/sec: 55.00

Run 2 tokens/sec: 55.02

Run 1 tokens/sec: 55.00

Run 2 tokens/sec: 55.01

Run 1 tokens/sec: 42.64

Run 2 tokens/sec: 55.01

Run 1 tokens/sec: 55.32

Run 2 tokens/sec: 55.29

→ length=2048, #samples=20
Len=2048:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]Len=2048:   5%|███▊                                                                        | 1/20 [00:10<03:13, 10.16s/it]Len=2048:  10%|███████▌                                                                    | 2/20 [00:21<03:16, 10.91s/it]Len=2048:  15%|███████████▍                                                                | 3/20 [00:31<02:59, 10.54s/it]Len=2048:  20%|███████████████▏                                                            | 4/20 [00:41<02:45, 10.37s/it]Len=2048:  25%|███████████████████                                                         | 5/20 [00:51<02:33, 10.25s/it]Len=2048:  30%|██████████████████████▊                                                     | 6/20 [01:01<02:22, 10.21s/it]Len=2048:  35%|██████████████████████████▌                                                 | 7/20 [01:13<02:20, 10.78s/it]Len=2048:  40%|██████████████████████████████▍                                             | 8/20 [01:24<02:07, 10.62s/it]Len=2048:  45%|██████████████████████████████████▏                                         | 9/20 [01:34<01:55, 10.48s/it]Len=2048:  50%|█████████████████████████████████████▌                                     | 10/20 [01:44<01:43, 10.36s/it]Len=2048:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:56<01:38, 10.90s/it]Len=2048:  60%|█████████████████████████████████████████████                              | 12/20 [02:06<01:25, 10.68s/it]Len=2048:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:16<01:13, 10.47s/it]Len=2048:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:26<01:02, 10.35s/it]Len=2048:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:38<00:53, 10.68s/it]Len=2048:  80%|████████████████████████████████████████████████████████████               | 16/20 [02:48<00:42, 10.52s/it]Len=2048:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [02:58<00:31, 10.38s/it]Len=2048:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [03:09<00:21, 10.71s/it]Len=2048:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:20<00:10, 10.55s/it]Len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:30<00:00, 10.41s/it]Len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:30<00:00, 10.51s/it]
Run 1 tokens/sec: 50.39

Run 2 tokens/sec: 50.42

Run 1 tokens/sec: 40.08

Run 2 tokens/sec: 50.72

Run 1 tokens/sec: 50.75

Run 2 tokens/sec: 50.75

Run 1 tokens/sec: 50.64

Run 2 tokens/sec: 50.62

Run 1 tokens/sec: 51.12

Run 2 tokens/sec: 51.12

Run 1 tokens/sec: 50.57

Run 2 tokens/sec: 50.57

Run 1 tokens/sec: 36.75

Run 2 tokens/sec: 51.25

Run 1 tokens/sec: 49.78

Run 2 tokens/sec: 49.77

Run 1 tokens/sec: 50.46

Run 2 tokens/sec: 50.45

Run 1 tokens/sec: 50.75

Run 2 tokens/sec: 50.73

Run 1 tokens/sec: 50.52

Run 2 tokens/sec: 36.23

Run 1 tokens/sec: 50.33

Run 2 tokens/sec: 50.32

Run 1 tokens/sec: 51.30

Run 2 tokens/sec: 51.31

Run 1 tokens/sec: 50.80

Run 2 tokens/sec: 50.81

Run 1 tokens/sec: 40.09

Run 2 tokens/sec: 50.68

Run 1 tokens/sec: 50.46

Run 2 tokens/sec: 50.47

Run 1 tokens/sec: 51.03

Run 2 tokens/sec: 51.03

Run 1 tokens/sec: 39.88

Run 2 tokens/sec: 50.62

Run 1 tokens/sec: 50.37

Run 2 tokens/sec: 50.38

Run 1 tokens/sec: 50.71

Run 2 tokens/sec: 50.69

→ length=4096, #samples=20
Len=4096:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]Len=4096:   5%|███▊                                                                        | 1/20 [00:13<04:11, 13.24s/it]Len=4096:  10%|███████▌                                                                    | 2/20 [00:25<03:46, 12.61s/it]Len=4096:  15%|███████████▍                                                                | 3/20 [00:37<03:30, 12.36s/it]Len=4096:  20%|███████████████▏                                                            | 4/20 [00:50<03:24, 12.78s/it]Len=4096:  25%|███████████████████                                                         | 5/20 [01:02<03:06, 12.46s/it]Len=4096:  30%|██████████████████████▊                                                     | 6/20 [01:16<02:58, 12.78s/it]Len=4096:  35%|██████████████████████████▌                                                 | 7/20 [01:27<02:41, 12.45s/it]Len=4096:  40%|██████████████████████████████▍                                             | 8/20 [01:39<02:27, 12.28s/it]Len=4096:  45%|██████████████████████████████████▏                                         | 9/20 [01:53<02:18, 12.59s/it]Len=4096:  50%|█████████████████████████████████████▌                                     | 10/20 [02:05<02:04, 12.42s/it]Len=4096:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:17<01:50, 12.28s/it]Len=4096:  60%|█████████████████████████████████████████████                              | 12/20 [02:30<01:40, 12.61s/it]Len=4096:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:42<01:26, 12.42s/it]Len=4096:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:55<01:16, 12.73s/it]Len=4096:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [03:07<01:02, 12.49s/it]Len=4096:  80%|████████████████████████████████████████████████████████████               | 16/20 [03:19<00:49, 12.36s/it]Len=4096:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [03:33<00:38, 12.67s/it]Len=4096:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [03:45<00:24, 12.43s/it]Len=4096:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:57<00:12, 12.32s/it]Len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [04:10<00:00, 12.60s/it]Len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [04:10<00:00, 12.53s/it]
Run 1 tokens/sec: 35.11

Run 2 tokens/sec: 43.09

Run 1 tokens/sec: 42.12

Run 2 tokens/sec: 42.13

Run 1 tokens/sec: 42.46

Run 2 tokens/sec: 42.45

Run 1 tokens/sec: 34.71

Run 2 tokens/sec: 42.45

Run 1 tokens/sec: 43.09

Run 2 tokens/sec: 43.10

Run 1 tokens/sec: 42.56

Run 2 tokens/sec: 34.69

Run 1 tokens/sec: 43.47

Run 2 tokens/sec: 43.43

Run 1 tokens/sec: 42.99

Run 2 tokens/sec: 42.98

Run 1 tokens/sec: 35.05

Run 2 tokens/sec: 42.97

Run 1 tokens/sec: 42.53

Run 2 tokens/sec: 42.53

Run 1 tokens/sec: 42.89

Run 2 tokens/sec: 42.77

Run 1 tokens/sec: 34.87

Run 2 tokens/sec: 42.66

Run 1 tokens/sec: 42.67

Run 2 tokens/sec: 42.87

Run 1 tokens/sec: 42.46

Run 2 tokens/sec: 34.57

Run 1 tokens/sec: 42.92

Run 2 tokens/sec: 42.92

Run 1 tokens/sec: 42.43

Run 2 tokens/sec: 42.44

Run 1 tokens/sec: 42.55

Run 2 tokens/sec: 34.80

Run 1 tokens/sec: 43.09

Run 2 tokens/sec: 43.12

Run 1 tokens/sec: 42.47

Run 2 tokens/sec: 42.46

Run 1 tokens/sec: 35.10

Run 2 tokens/sec: 43.10

→ length=8192, #samples=20
Len=8192:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]Len=8192:   5%|███▊                                                                        | 1/20 [00:15<04:51, 15.33s/it]Len=8192:  10%|███████▌                                                                    | 2/20 [00:32<04:50, 16.14s/it]Len=8192:  15%|███████████▍                                                                | 3/20 [00:47<04:26, 15.71s/it]Len=8192:  20%|███████████████▏                                                            | 4/20 [01:03<04:17, 16.07s/it]Len=8192:  25%|███████████████████                                                         | 5/20 [01:18<03:55, 15.70s/it]Len=8192:  30%|██████████████████████▊                                                     | 6/20 [01:35<03:45, 16.13s/it]Len=8192:  35%|██████████████████████████▌                                                 | 7/20 [01:51<03:27, 15.95s/it]Len=8192:  40%|██████████████████████████████▍                                             | 8/20 [02:08<03:13, 16.16s/it]Len=8192:  45%|██████████████████████████████████▏                                         | 9/20 [02:23<02:54, 15.90s/it]Len=8192:  50%|█████████████████████████████████████▌                                     | 10/20 [02:40<02:42, 16.23s/it]Len=8192:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:55<02:23, 15.95s/it]Len=8192:  60%|█████████████████████████████████████████████                              | 12/20 [03:11<02:06, 15.84s/it]Len=8192:  65%|████████████████████████████████████████████████▊                          | 13/20 [03:28<01:53, 16.16s/it]Len=8192:  70%|████████████████████████████████████████████████████▌                      | 14/20 [03:43<01:36, 16.00s/it]Len=8192:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [04:00<01:21, 16.23s/it]Len=8192:  80%|████████████████████████████████████████████████████████████               | 16/20 [04:15<01:03, 15.97s/it]Len=8192:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [04:32<00:48, 16.24s/it]Len=8192:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [04:48<00:31, 15.97s/it]Len=8192:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [05:04<00:16, 16.16s/it]Len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:20<00:00, 15.98s/it]Len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:20<00:00, 16.01s/it]
Run 1 tokens/sec: 33.42

Run 2 tokens/sec: 33.42

Run 1 tokens/sec: 33.34

Run 2 tokens/sec: 28.41

Run 1 tokens/sec: 33.73

Run 2 tokens/sec: 33.74

Run 1 tokens/sec: 33.53

Run 2 tokens/sec: 28.48

Run 1 tokens/sec: 34.08

Run 2 tokens/sec: 34.09

Run 1 tokens/sec: 32.76

Run 2 tokens/sec: 27.97

Run 1 tokens/sec: 32.92

Run 2 tokens/sec: 32.92

Run 1 tokens/sec: 33.58

Run 2 tokens/sec: 28.52

Run 1 tokens/sec: 33.46

Run 2 tokens/sec: 33.46

Run 1 tokens/sec: 32.80

Run 2 tokens/sec: 27.96

Run 1 tokens/sec: 33.42

Run 2 tokens/sec: 33.42

Run 1 tokens/sec: 32.92

Run 2 tokens/sec: 32.93

Run 1 tokens/sec: 28.07

Run 2 tokens/sec: 32.99

Run 1 tokens/sec: 32.76

Run 2 tokens/sec: 32.73

Run 1 tokens/sec: 28.29

Run 2 tokens/sec: 33.25

Run 1 tokens/sec: 33.38

Run 2 tokens/sec: 33.37

Run 1 tokens/sec: 28.11

Run 2 tokens/sec: 33.00

Run 1 tokens/sec: 33.44

Run 2 tokens/sec: 33.43

Run 1 tokens/sec: 28.55

Run 2 tokens/sec: 33.57

Run 1 tokens/sec: 32.89

Run 2 tokens/sec: 32.89

→ length=16384, #samples=20
Len=16384:   0%|                                                                                   | 0/20 [00:00<?, ?it/s]Len=16384:   5%|███▊                                                                       | 1/20 [00:22<07:16, 22.95s/it]Len=16384:  10%|███████▌                                                                   | 2/20 [00:45<06:52, 22.92s/it]Len=16384:  15%|███████████▎                                                               | 3/20 [01:07<06:16, 22.12s/it]Len=16384:  20%|███████████████                                                            | 4/20 [01:30<06:01, 22.59s/it]Len=16384:  25%|██████████████████▊                                                        | 5/20 [01:53<05:39, 22.64s/it]Len=16384:  30%|██████████████████████▌                                                    | 6/20 [02:15<05:16, 22.63s/it]Len=16384:  35%|██████████████████████████▎                                                | 7/20 [02:39<04:57, 22.92s/it]Len=16384:  40%|██████████████████████████████                                             | 8/20 [03:02<04:35, 22.96s/it]Len=16384:  45%|█████████████████████████████████▊                                         | 9/20 [03:23<04:07, 22.53s/it]Len=16384:  50%|█████████████████████████████████████                                     | 10/20 [03:46<03:46, 22.62s/it]Len=16384:  55%|████████████████████████████████████████▋                                 | 11/20 [04:09<03:23, 22.58s/it]Len=16384:  60%|████████████████████████████████████████████▍                             | 12/20 [04:31<02:59, 22.46s/it]Len=16384:  65%|████████████████████████████████████████████████                          | 13/20 [04:54<02:38, 22.63s/it]Len=16384:  70%|███████████████████████████████████████████████████▊                      | 14/20 [05:17<02:17, 22.85s/it]Len=16384:  75%|███████████████████████████████████████████████████████▌                  | 15/20 [05:39<01:52, 22.50s/it]Len=16384:  80%|███████████████████████████████████████████████████████████▏              | 16/20 [06:02<01:30, 22.70s/it]Len=16384:  85%|██████████████████████████████████████████████████████████████▉           | 17/20 [06:25<01:08, 22.70s/it]Len=16384:  90%|██████████████████████████████████████████████████████████████████▌       | 18/20 [06:47<00:44, 22.49s/it]Len=16384:  95%|██████████████████████████████████████████████████████████████████████▎   | 19/20 [07:10<00:22, 22.82s/it]Len=16384: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [07:34<00:00, 23.03s/it]Len=16384: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [07:34<00:00, 22.72s/it]
Run 1 tokens/sec: 21.10

Run 2 tokens/sec: 23.72

Run 1 tokens/sec: 23.78

Run 2 tokens/sec: 21.15

Run 1 tokens/sec: 24.20

Run 2 tokens/sec: 24.20

Run 1 tokens/sec: 20.78

Run 2 tokens/sec: 23.34

Run 1 tokens/sec: 23.98

Run 2 tokens/sec: 21.29

Run 1 tokens/sec: 22.28

Run 2 tokens/sec: 23.05

Run 1 tokens/sec: 20.63

Run 2 tokens/sec: 23.14

Run 1 tokens/sec: 23.60

Run 2 tokens/sec: 21.01

Run 1 tokens/sec: 23.74

Run 2 tokens/sec: 23.74

Run 1 tokens/sec: 21.21

Run 2 tokens/sec: 23.88

Run 1 tokens/sec: 24.23

Run 2 tokens/sec: 21.48

Run 1 tokens/sec: 23.11

Run 2 tokens/sec: 23.12

Run 1 tokens/sec: 21.06

Run 2 tokens/sec: 23.63

Run 1 tokens/sec: 23.31

Run 2 tokens/sec: 20.72

Run 1 tokens/sec: 23.65

Run 2 tokens/sec: 23.58

Run 1 tokens/sec: 20.90

Run 2 tokens/sec: 23.51

Run 1 tokens/sec: 24.02

Run 2 tokens/sec: 21.34

Run 1 tokens/sec: 23.27

Run 2 tokens/sec: 23.29

Run 1 tokens/sec: 20.54

Run 2 tokens/sec: 23.05

Run 1 tokens/sec: 23.15

Run 2 tokens/sec: 20.61

✅ Experiment complete!
Loading checkpoint shards:   0%|                                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|███████████████                                             | 1/4 [00:00<00:02,  1.46it/s]Loading checkpoint shards:  50%|██████████████████████████████                              | 2/4 [00:01<00:01,  1.45it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████               | 3/4 [00:02<00:00,  1.47it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  2.06it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.79it/s]
→ length=1024, #samples=20
Len=1024:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
Len=1024:   5%|███▊                                                                        | 1/20 [00:09<03:01,  9.55s/it]Len=1024:  10%|███████▌                                                                    | 2/20 [00:20<03:02, 10.15s/it]Len=1024:  15%|███████████▍                                                                | 3/20 [00:29<02:45,  9.76s/it]Len=1024:  20%|███████████████▏                                                            | 4/20 [00:38<02:33,  9.59s/it]Len=1024:  25%|███████████████████                                                         | 5/20 [00:48<02:22,  9.50s/it]Len=1024:  30%|██████████████████████▊                                                     | 6/20 [00:58<02:18,  9.88s/it]Len=1024:  35%|██████████████████████████▌                                                 | 7/20 [01:08<02:06,  9.71s/it]Len=1024:  40%|██████████████████████████████▍                                             | 8/20 [01:17<01:54,  9.57s/it]Len=1024:  45%|██████████████████████████████████▏                                         | 9/20 [01:27<01:48,  9.90s/it]Len=1024:  50%|█████████████████████████████████████▌                                     | 10/20 [01:37<01:37,  9.71s/it]Len=1024:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:46<01:26,  9.57s/it]Len=1024:  60%|█████████████████████████████████████████████                              | 12/20 [01:55<01:15,  9.48s/it]Len=1024:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:06<01:08,  9.83s/it]Len=1024:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:15<00:57,  9.66s/it]Len=1024:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:24<00:47,  9.54s/it]Len=1024:  80%|████████████████████████████████████████████████████████████               | 16/20 [02:35<00:39,  9.86s/it]Len=1024:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [02:44<00:29,  9.69s/it]Len=1024:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [02:54<00:19,  9.56s/it]Len=1024:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:03<00:09,  9.47s/it]Len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:13<00:00,  9.81s/it]Len=1024: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:13<00:00,  9.70s/it]
Run 1 tokens/sec: 52.52

Run 2 tokens/sec: 54.82

Run 1 tokens/sec: 55.56

Run 2 tokens/sec: 42.96

Run 1 tokens/sec: 55.10

Run 2 tokens/sec: 55.07

Run 1 tokens/sec: 54.92

Run 2 tokens/sec: 54.92

Run 1 tokens/sec: 55.46

Run 2 tokens/sec: 54.18

Run 1 tokens/sec: 42.75

Run 2 tokens/sec: 55.24

Run 1 tokens/sec: 54.83

Run 2 tokens/sec: 54.80

Run 1 tokens/sec: 55.18

Run 2 tokens/sec: 55.20

Run 1 tokens/sec: 55.26

Run 2 tokens/sec: 42.74

Run 1 tokens/sec: 55.16

Run 2 tokens/sec: 55.15

Run 1 tokens/sec: 55.26

Run 2 tokens/sec: 55.26

Run 1 tokens/sec: 55.18

Run 2 tokens/sec: 55.20

Run 1 tokens/sec: 42.75

Run 2 tokens/sec: 55.29

Run 1 tokens/sec: 55.31

Run 2 tokens/sec: 55.33

Run 1 tokens/sec: 55.24

Run 2 tokens/sec: 55.22

Run 1 tokens/sec: 55.26

Run 2 tokens/sec: 42.84

Run 1 tokens/sec: 55.11

Run 2 tokens/sec: 55.10

Run 1 tokens/sec: 55.31

Run 2 tokens/sec: 55.32

Run 1 tokens/sec: 55.37

Run 2 tokens/sec: 55.35

Run 1 tokens/sec: 42.81

Run 2 tokens/sec: 55.25

→ length=2048, #samples=20
Len=2048:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]Len=2048:   5%|███▊                                                                        | 1/20 [00:10<03:13, 10.21s/it]Len=2048:  10%|███████▌                                                                    | 2/20 [00:20<03:02, 10.17s/it]Len=2048:  15%|███████████▍                                                                | 3/20 [00:31<03:03, 10.81s/it]Len=2048:  20%|███████████████▏                                                            | 4/20 [00:42<02:49, 10.57s/it]Len=2048:  25%|███████████████████                                                         | 5/20 [00:52<02:36, 10.43s/it]Len=2048:  30%|██████████████████████▊                                                     | 6/20 [01:03<02:30, 10.75s/it]Len=2048:  35%|██████████████████████████▌                                                 | 7/20 [01:13<02:16, 10.53s/it]Len=2048:  40%|██████████████████████████████▍                                             | 8/20 [01:23<02:05, 10.42s/it]Len=2048:  45%|██████████████████████████████████▏                                         | 9/20 [01:35<01:58, 10.78s/it]Len=2048:  50%|█████████████████████████████████████▌                                     | 10/20 [01:45<01:46, 10.60s/it]Len=2048:  55%|█████████████████████████████████████████▎                                 | 11/20 [01:55<01:34, 10.49s/it]Len=2048:  60%|█████████████████████████████████████████████                              | 12/20 [02:06<01:23, 10.41s/it]Len=2048:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:17<01:15, 10.73s/it]Len=2048:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:27<01:03, 10.56s/it]Len=2048:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [02:37<00:51, 10.38s/it]Len=2048:  80%|████████████████████████████████████████████████████████████               | 16/20 [02:49<00:42, 10.73s/it]Len=2048:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [02:59<00:31, 10.54s/it]Len=2048:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [03:09<00:20, 10.39s/it]Len=2048:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:20<00:10, 10.72s/it]Len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:30<00:00, 10.49s/it]Len=2048: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [03:30<00:00, 10.55s/it]
Run 1 tokens/sec: 50.16

Run 2 tokens/sec: 50.18

Run 1 tokens/sec: 50.58

Run 2 tokens/sec: 50.51

Run 1 tokens/sec: 50.12

Run 2 tokens/sec: 39.59

Run 1 tokens/sec: 49.87

Run 2 tokens/sec: 50.63

Run 1 tokens/sec: 50.30

Run 2 tokens/sec: 50.31

Run 1 tokens/sec: 51.11

Run 2 tokens/sec: 40.32

Run 1 tokens/sec: 50.81

Run 2 tokens/sec: 50.82

Run 1 tokens/sec: 50.32

Run 2 tokens/sec: 50.32

Run 1 tokens/sec: 50.10

Run 2 tokens/sec: 39.65

Run 1 tokens/sec: 50.13

Run 2 tokens/sec: 50.13

Run 1 tokens/sec: 50.10

Run 2 tokens/sec: 50.12

Run 1 tokens/sec: 50.01

Run 2 tokens/sec: 50.02

Run 1 tokens/sec: 40.07

Run 2 tokens/sec: 50.48

Run 1 tokens/sec: 50.33

Run 2 tokens/sec: 50.32

Run 1 tokens/sec: 51.47

Run 2 tokens/sec: 51.48

Run 1 tokens/sec: 39.74

Run 2 tokens/sec: 50.30

Run 1 tokens/sec: 50.59

Run 2 tokens/sec: 50.60

Run 1 tokens/sec: 51.05

Run 2 tokens/sec: 51.00

Run 1 tokens/sec: 39.91

Run 2 tokens/sec: 50.51

Run 1 tokens/sec: 51.41

Run 2 tokens/sec: 51.41

→ length=4096, #samples=20
Len=4096:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]Len=4096:   5%|███▊                                                                        | 1/20 [00:12<03:48, 12.04s/it]Len=4096:  10%|███████▌                                                                    | 2/20 [00:25<03:49, 12.78s/it]Len=4096:  15%|███████████▍                                                                | 3/20 [00:37<03:32, 12.49s/it]Len=4096:  20%|███████████████▏                                                            | 4/20 [00:49<03:17, 12.32s/it]Len=4096:  25%|███████████████████                                                         | 5/20 [01:02<03:10, 12.71s/it]Len=4096:  30%|██████████████████████▊                                                     | 6/20 [01:15<02:54, 12.49s/it]Len=4096:  35%|██████████████████████████▌                                                 | 7/20 [01:28<02:45, 12.75s/it]Len=4096:  40%|██████████████████████████████▍                                             | 8/20 [01:40<02:30, 12.54s/it]Len=4096:  45%|██████████████████████████████████▏                                         | 9/20 [01:52<02:16, 12.37s/it]Len=4096:  50%|█████████████████████████████████████▌                                     | 10/20 [02:05<02:06, 12.69s/it]Len=4096:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:17<01:52, 12.51s/it]Len=4096:  60%|█████████████████████████████████████████████                              | 12/20 [02:29<01:38, 12.37s/it]Len=4096:  65%|████████████████████████████████████████████████▊                          | 13/20 [02:43<01:28, 12.69s/it]Len=4096:  70%|████████████████████████████████████████████████████▌                      | 14/20 [02:55<01:14, 12.45s/it]Len=4096:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [03:08<01:03, 12.75s/it]Len=4096:  80%|████████████████████████████████████████████████████████████               | 16/20 [03:20<00:50, 12.50s/it]Len=4096:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [03:32<00:37, 12.37s/it]Len=4096:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [03:46<00:25, 12.70s/it]Len=4096:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [03:58<00:12, 12.49s/it]Len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [04:10<00:00, 12.37s/it]Len=4096: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [04:10<00:00, 12.51s/it]
Run 1 tokens/sec: 42.51

Run 2 tokens/sec: 42.61

Run 1 tokens/sec: 35.00

Run 2 tokens/sec: 42.88

Run 1 tokens/sec: 42.17

Run 2 tokens/sec: 42.18

Run 1 tokens/sec: 42.44

Run 2 tokens/sec: 42.45

Run 1 tokens/sec: 34.72

Run 2 tokens/sec: 42.46

Run 1 tokens/sec: 42.50

Run 2 tokens/sec: 42.47

Run 1 tokens/sec: 42.97

Run 2 tokens/sec: 35.00

Run 1 tokens/sec: 42.39

Run 2 tokens/sec: 42.30

Run 1 tokens/sec: 42.68

Run 2 tokens/sec: 42.69

Run 1 tokens/sec: 34.72

Run 2 tokens/sec: 42.47

Run 1 tokens/sec: 42.38

Run 2 tokens/sec: 42.39

Run 1 tokens/sec: 42.53

Run 2 tokens/sec: 42.51

Run 1 tokens/sec: 34.68

Run 2 tokens/sec: 42.40

Run 1 tokens/sec: 42.99

Run 2 tokens/sec: 42.99

Run 1 tokens/sec: 42.45

Run 2 tokens/sec: 34.62

Run 1 tokens/sec: 42.98

Run 2 tokens/sec: 42.97

Run 1 tokens/sec: 42.51

Run 2 tokens/sec: 42.51

Run 1 tokens/sec: 42.24

Run 2 tokens/sec: 34.58

Run 1 tokens/sec: 42.68

Run 2 tokens/sec: 42.69

Run 1 tokens/sec: 42.33

Run 2 tokens/sec: 42.43

→ length=8192, #samples=20
Len=8192:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]Len=8192:   5%|███▊                                                                        | 1/20 [00:17<05:30, 17.42s/it]Len=8192:  10%|███████▌                                                                    | 2/20 [00:33<04:57, 16.51s/it]Len=8192:  15%|███████████▍                                                                | 3/20 [00:49<04:39, 16.44s/it]Len=8192:  20%|███████████████▏                                                            | 4/20 [01:05<04:16, 16.03s/it]Len=8192:  25%|███████████████████                                                         | 5/20 [01:22<04:06, 16.44s/it]Len=8192:  30%|██████████████████████▊                                                     | 6/20 [01:38<03:47, 16.23s/it]Len=8192:  35%|██████████████████████████▌                                                 | 7/20 [01:54<03:33, 16.45s/it]Len=8192:  40%|██████████████████████████████▍                                             | 8/20 [02:10<03:14, 16.20s/it]Len=8192:  45%|██████████████████████████████████▏                                         | 9/20 [02:27<03:00, 16.41s/it]Len=8192:  50%|█████████████████████████████████████▌                                     | 10/20 [02:43<02:42, 16.22s/it]Len=8192:  55%|█████████████████████████████████████████▎                                 | 11/20 [02:59<02:26, 16.32s/it]Len=8192:  60%|█████████████████████████████████████████████                              | 12/20 [03:15<02:07, 15.99s/it]Len=8192:  65%|████████████████████████████████████████████████▊                          | 13/20 [03:32<01:54, 16.35s/it]Len=8192:  70%|████████████████████████████████████████████████████▌                      | 14/20 [03:48<01:37, 16.21s/it]Len=8192:  75%|████████████████████████████████████████████████████████▎                  | 15/20 [04:05<01:22, 16.58s/it]Len=8192:  80%|████████████████████████████████████████████████████████████               | 16/20 [04:21<01:05, 16.37s/it]Len=8192:  85%|███████████████████████████████████████████████████████████████▊           | 17/20 [04:38<00:49, 16.57s/it]Len=8192:  90%|███████████████████████████████████████████████████████████████████▌       | 18/20 [04:54<00:32, 16.38s/it]Len=8192:  95%|███████████████████████████████████████████████████████████████████████▎   | 19/20 [05:11<00:16, 16.56s/it]Len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:27<00:00, 16.34s/it]Len=8192: 100%|███████████████████████████████████████████████████████████████████████████| 20/20 [05:27<00:00, 16.36s/it]
Run 1 tokens/sec: 27.32

Run 2 tokens/sec: 31.89

Run 1 tokens/sec: 32.29

Run 2 tokens/sec: 32.27

Run 1 tokens/sec: 28.92

Run 2 tokens/sec: 34.21

Run 1 tokens/sec: 33.28

Run 2 tokens/sec: 33.25

Run 1 tokens/sec: 27.65

Run 2 tokens/sec: 32.39

Run 1 tokens/sec: 32.41

Run 2 tokens/sec: 32.42

Run 1 tokens/sec: 28.08

Run 2 tokens/sec: 32.97

Run 1 tokens/sec: 32.67

Run 2 tokens/sec: 32.67

Run 1 tokens/sec: 28.17

Run 2 tokens/sec: 33.02

Run 1 tokens/sec: 32.45

Run 2 tokens/sec: 32.46

Run 1 tokens/sec: 33.73

Run 2 tokens/sec: 28.64

Run 1 tokens/sec: 33.63

Run 2 tokens/sec: 33.62

Run 1 tokens/sec: 32.40

Run 2 tokens/sec: 27.62

Run 1 tokens/sec: 32.29

Run 2 tokens/sec: 32.29

Run 1 tokens/sec: 31.81

Run 2 tokens/sec: 27.25

Run 1 tokens/sec: 32.30

Run 2 tokens/sec: 32.24

Run 1 tokens/sec: 32.66

Run 2 tokens/sec: 27.92

Run 1 tokens/sec: 32.11

Run 2 tokens/sec: 32.13

Run 1 tokens/sec: 32.77

Run 2 tokens/sec: 28.02

Run 1 tokens/sec: 32.36

Run 2 tokens/sec: 32.35

→ length=16000, #samples=20
Len=16000:   0%|                                                                                   | 0/20 [00:00<?, ?it/s]Len=16000:   5%|███▊                                                                       | 1/20 [00:22<07:03, 22.28s/it]Len=16000:  10%|███████▌                                                                   | 2/20 [00:43<06:24, 21.38s/it]Len=16000:  15%|███████████▎                                                               | 3/20 [01:05<06:09, 21.71s/it]Len=16000:  20%|███████████████                                                            | 4/20 [01:27<05:50, 21.93s/it]Len=16000:  25%|██████████████████▊                                                        | 5/20 [01:48<05:23, 21.56s/it]Len=16000:  30%|██████████████████████▌                                                    | 6/20 [02:10<05:06, 21.92s/it]Len=16000:  35%|██████████████████████████▎                                                | 7/20 [02:34<04:51, 22.42s/it]Len=16000:  40%|██████████████████████████████                                             | 8/20 [02:55<04:25, 22.15s/it]Len=16000:  45%|█████████████████████████████████▊                                         | 9/20 [03:18<04:03, 22.16s/it]Len=16000:  50%|█████████████████████████████████████                                     | 10/20 [03:42<03:47, 22.73s/it]Len=16000:  55%|████████████████████████████████████████▋                                 | 11/20 [04:03<03:21, 22.34s/it]Len=16000:  60%|████████████████████████████████████████████▍                             | 12/20 [04:26<03:00, 22.61s/it]Len=16000:  65%|████████████████████████████████████████████████                          | 13/20 [04:48<02:36, 22.42s/it]Len=16000:  70%|███████████████████████████████████████████████████▊                      | 14/20 [05:09<02:11, 21.87s/it]Len=16000:  75%|███████████████████████████████████████████████████████▌                  | 15/20 [05:32<01:51, 22.37s/it]Len=16000:  80%|███████████████████████████████████████████████████████████▏              | 16/20 [05:54<01:29, 22.27s/it]Len=16000:  85%|██████████████████████████████████████████████████████████████▉           | 17/20 [06:16<01:06, 22.14s/it]Len=16000:  90%|██████████████████████████████████████████████████████████████████▌       | 18/20 [06:39<00:44, 22.41s/it]Len=16000:  95%|██████████████████████████████████████████████████████████████████████▎   | 19/20 [07:02<00:22, 22.63s/it]Len=16000: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [07:24<00:00, 22.28s/it]Len=16000: 100%|██████████████████████████████████████████████████████████████████████████| 20/20 [07:24<00:00, 22.22s/it]
Run 1 tokens/sec: 24.49

Run 2 tokens/sec: 21.68

Run 1 tokens/sec: 24.70

Run 2 tokens/sec: 24.71

Run 1 tokens/sec: 21.84

Run 2 tokens/sec: 24.71

Run 1 tokens/sec: 24.52

Run 2 tokens/sec: 21.71

Run 1 tokens/sec: 24.51

Run 2 tokens/sec: 24.52

Run 1 tokens/sec: 21.40

Run 2 tokens/sec: 24.10

Run 1 tokens/sec: 23.17

Run 2 tokens/sec: 20.67

Run 1 tokens/sec: 23.75

Run 2 tokens/sec: 23.75

Run 1 tokens/sec: 21.79

Run 2 tokens/sec: 24.63

Run 1 tokens/sec: 22.38

Run 2 tokens/sec: 20.38

Run 1 tokens/sec: 23.90

Run 2 tokens/sec: 23.90

Run 1 tokens/sec: 20.83

Run 2 tokens/sec: 23.42

Run 1 tokens/sec: 24.84

Run 2 tokens/sec: 21.97

Run 1 tokens/sec: 24.89

Run 2 tokens/sec: 24.89

Run 1 tokens/sec: 20.60

Run 2 tokens/sec: 23.13

Run 1 tokens/sec: 24.76

Run 2 tokens/sec: 21.89

Run 1 tokens/sec: 23.47

Run 2 tokens/sec: 23.47

Run 1 tokens/sec: 21.03

Run 2 tokens/sec: 23.66

Run 1 tokens/sec: 23.52

Run 2 tokens/sec: 20.93

Run 1 tokens/sec: 23.86

Run 2 tokens/sec: 23.86

✅ Experiment complete!
Loading checkpoint shards:   0%|                                                                    | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|███████████████                                             | 1/4 [00:00<00:02,  1.44it/s]Loading checkpoint shards:  50%|██████████████████████████████                              | 2/4 [00:01<00:01,  1.43it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████               | 3/4 [00:02<00:00,  1.45it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  2.03it/s]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.77it/s]
→ length=1024, #samples=20
Len=1024:   0%|                                                                                    | 0/20 [00:00<?, ?it/s]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
Len=1024:   5%|███▊                                                                        | 1/20 [00:10<03:28, 11.00s/it]./run_exp.sh: line 51: 2388884 Killed                  python exp_llama3_ar_4_43.py --dataset_name booksum
Requirement already satisfied: transformers in ./spec-env/lib/python3.12/site-packages (4.43.0)
Collecting transformers
  Using cached transformers-4.53.0-py3-none-any.whl.metadata (39 kB)
Requirement already satisfied: filelock in ./spec-env/lib/python3.12/site-packages (from transformers) (3.18.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.30.0 in ./spec-env/lib/python3.12/site-packages (from transformers) (0.33.2)
Requirement already satisfied: numpy>=1.17 in ./spec-env/lib/python3.12/site-packages (from transformers) (2.3.1)
Requirement already satisfied: packaging>=20.0 in ./spec-env/lib/python3.12/site-packages (from transformers) (25.0)
Requirement already satisfied: pyyaml>=5.1 in ./spec-env/lib/python3.12/site-packages (from transformers) (6.0.2)
Requirement already satisfied: regex!=2019.12.17 in ./spec-env/lib/python3.12/site-packages (from transformers) (2024.11.6)
Requirement already satisfied: requests in ./spec-env/lib/python3.12/site-packages (from transformers) (2.32.4)
Collecting tokenizers<0.22,>=0.21 (from transformers)
  Using cached tokenizers-0.21.2-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.8 kB)
Requirement already satisfied: safetensors>=0.4.3 in ./spec-env/lib/python3.12/site-packages (from transformers) (0.5.3)
Requirement already satisfied: tqdm>=4.27 in ./spec-env/lib/python3.12/site-packages (from transformers) (4.67.1)
Requirement already satisfied: fsspec>=2023.5.0 in ./spec-env/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (2025.5.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in ./spec-env/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (4.14.0)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.2 in ./spec-env/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (1.1.5)
Requirement already satisfied: charset_normalizer<4,>=2 in ./spec-env/lib/python3.12/site-packages (from requests->transformers) (3.4.2)
Requirement already satisfied: idna<4,>=2.5 in ./spec-env/lib/python3.12/site-packages (from requests->transformers) (3.10)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./spec-env/lib/python3.12/site-packages (from requests->transformers) (2.5.0)
Requirement already satisfied: certifi>=2017.4.17 in ./spec-env/lib/python3.12/site-packages (from requests->transformers) (2025.6.15)
Using cached transformers-4.53.0-py3-none-any.whl (10.8 MB)
Using cached tokenizers-0.21.2-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.1 MB)
Installing collected packages: tokenizers, transformers
  Attempting uninstall: tokenizers
    Found existing installation: tokenizers 0.19.1
    Uninstalling tokenizers-0.19.1:
      Successfully uninstalled tokenizers-0.19.1
  Attempting uninstall: transformers
    Found existing installation: transformers 4.43.0
    Uninstalling transformers-4.43.0:
      Successfully uninstalled transformers-4.43.0

Successfully installed tokenizers-0.21.2 transformers-4.53.0
Requirement already satisfied: accelerate in ./spec-env/lib/python3.12/site-packages (0.21.0)
Requirement already satisfied: numpy>=1.17 in ./spec-env/lib/python3.12/site-packages (from accelerate) (2.3.1)
Requirement already satisfied: packaging>=20.0 in ./spec-env/lib/python3.12/site-packages (from accelerate) (25.0)
Requirement already satisfied: psutil in ./spec-env/lib/python3.12/site-packages (from accelerate) (7.0.0)
Requirement already satisfied: pyyaml in ./spec-env/lib/python3.12/site-packages (from accelerate) (6.0.2)
Requirement already satisfied: torch>=1.10.0 in ./spec-env/lib/python3.12/site-packages (from accelerate) (2.4.0+cu121)
Requirement already satisfied: filelock in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (3.18.0)
Requirement already satisfied: typing-extensions>=4.8.0 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (4.14.0)
Requirement already satisfied: sympy in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (1.14.0)
Requirement already satisfied: networkx in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (3.5)
Requirement already satisfied: jinja2 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (3.1.6)
Requirement already satisfied: fsspec in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (2025.5.1)
Requirement already satisfied: setuptools in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (80.9.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (12.1.105)
Requirement already satisfied: triton==3.0.0 in ./spec-env/lib/python3.12/site-packages (from torch>=1.10.0->accelerate) (3.0.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in ./spec-env/lib/python3.12/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch>=1.10.0->accelerate) (12.9.86)
Requirement already satisfied: MarkupSafe>=2.0 in ./spec-env/lib/python3.12/site-packages (from jinja2->torch>=1.10.0->accelerate) (3.0.2)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in ./spec-env/lib/python3.12/site-packages (from sympy->torch>=1.10.0->accelerate) (1.3.0)
Traceback (most recent call last):
  File "/home/hjkim/workspace/SpecExtend_Reb/exp_llama3_ar.py", line 41, in <module>
    model     = AutoModelForCausalLM.from_pretrained(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/models/auto/auto_factory.py", line 600, in from_pretrained
    return model_class.from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/modeling_utils.py", line 311, in _wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/modeling_utils.py", line 4540, in from_pretrained
    raise ValueError(
ValueError: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
Traceback (most recent call last):
  File "/home/hjkim/workspace/SpecExtend_Reb/exp_llama3_ar.py", line 41, in <module>
    model     = AutoModelForCausalLM.from_pretrained(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/models/auto/auto_factory.py", line 600, in from_pretrained
    return model_class.from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/modeling_utils.py", line 311, in _wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/modeling_utils.py", line 4540, in from_pretrained
    raise ValueError(
ValueError: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
Traceback (most recent call last):
  File "/home/hjkim/workspace/SpecExtend_Reb/exp_llama3_ar.py", line 41, in <module>
    model     = AutoModelForCausalLM.from_pretrained(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/models/auto/auto_factory.py", line 600, in from_pretrained
    return model_class.from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/modeling_utils.py", line 311, in _wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/hjkim/workspace/SpecExtend_Reb/spec-env/lib/python3.12/site-packages/transformers/modeling_utils.py", line 4540, in from_pretrained
    raise ValueError(
ValueError: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
